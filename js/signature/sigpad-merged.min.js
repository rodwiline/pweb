"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(e,n){var r,t,i,u;for("undefined"==typeof n&&(n=15),i=.5,r=new Date;;){for(i*=2,u=i;u>3;u-=4)e(),e(),e(),e();for(;u>0;)e(),u--;if(t=new Date,t-r>n)break}for(u=i;u>3;u-=4)e(),e(),e(),e();for(;u>0;)e(),u--;return t=new Date,1e3*(3*i-1)/(t-r)},numeric._myIndexOf=function(e){var r,n=this.length;for(r=0;n>r;++r)if(this[r]===e)return r;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(e){function n(e){if(0===e)return"0";if(isNaN(e))return"NaN";if(0>e)return"-"+n(-e);if(isFinite(e)){var r=Math.floor(Math.log(e)/Math.log(10)),t=e/Math.pow(10,r),i=t.toPrecision(numeric.precision);return 10===parseFloat(i)&&(r++,t=1,i=t.toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+r.toString()}return"Infinity"}function r(e){var i;if("undefined"==typeof e)return t.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof e)return t.push('"'+e+'"'),!1;if("boolean"==typeof e)return t.push(e.toString()),!1;if("number"==typeof e){var u=n(e),o=e.toPrecision(numeric.precision),a=parseFloat(e.toString()).toString(),c=[u,o,a,parseFloat(o).toString(),parseFloat(a).toString()];for(i=1;i<c.length;i++)c[i].length<u.length&&(u=c[i]);return t.push(Array(numeric.precision+8-u.length).join(" ")+u),!1}if(null===e)return t.push("null"),!1;if("function"==typeof e){t.push(e.toString());var s=!1;for(i in e)e.hasOwnProperty(i)&&(s?t.push(",\n"):t.push("\n{"),s=!0,t.push(i),t.push(": \n"),r(e[i]));return s&&t.push("}\n"),!0}if(e instanceof Array){if(e.length>numeric.largeArray)return t.push("...Large Array..."),!0;var s=!1;for(t.push("["),i=0;i<e.length;i++)i>0&&(t.push(","),s&&t.push("\n ")),s=r(e[i]);return t.push("]"),!0}t.push("{");var s=!1;for(i in e)e.hasOwnProperty(i)&&(s&&t.push(",\n"),s=!0,t.push(i),t.push(": \n"),r(e[i]));return t.push("}"),!0}var t=[];return r(e),t.join("")},numeric.parseDate=function(e){function n(e){if("string"==typeof e)return Date.parse(e.replace(/-/g,"/"));if(e instanceof Array){var t,r=[];for(t=0;t<e.length;t++)r[t]=n(e[t]);return r}throw new Error("parseDate: parameter must be arrays of strings")}return n(e)},numeric.parseFloat=function(e){function n(e){if("string"==typeof e)return parseFloat(e);if(e instanceof Array){var t,r=[];for(t=0;t<e.length;t++)r[t]=n(e[t]);return r}throw new Error("parseFloat: parameter must be arrays of strings")}return n(e)},numeric.parseCSV=function(e){var r,t,n=e.split("\n"),i=[],u=/(([^'",]*)|('[^']*')|("[^"]*")),/g,o=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,a=function(e){return e.substr(0,e.length-1)},c=0;for(t=0;t<n.length;t++){var f,s=(n[t]+",").match(u);if(s.length>0){for(i[c]=[],r=0;r<s.length;r++)f=a(s[r]),o.test(f)?i[c][r]=parseFloat(f):i[c][r]=f;c++}}return i},numeric.toCSV=function(e){var r,t,i,u,o,a,n=numeric.dim(e);for(i=n[0],u=n[1],a=[],r=0;i>r;r++){for(o=[],t=0;i>t;t++)o[t]=e[r][t].toString();a[r]=o.join(", ")}return a.join("\n")+"\n"},numeric.getURL=function(e){var n=new XMLHttpRequest;return n.open("GET",e,!1),n.send(),n},numeric.imageURL=function(e){function n(e){var r,t,i,u,o,a,c,s,n=e.length,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="";for(r=0;n>r;r+=3)t=e[r],i=e[r+1],u=e[r+2],o=t>>2,a=((3&t)<<4)+(i>>4),c=((15&i)<<2)+(u>>6),s=63&u,r+1>=n?c=s=64:r+2>=n&&(s=64),l+=f.charAt(o)+f.charAt(a)+f.charAt(c)+f.charAt(s);return l}function r(e,n,r){"undefined"==typeof n&&(n=0),"undefined"==typeof r&&(r=e.length);var a,t=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],i=-1,u=0;e.length;for(a=n;r>a;a++)u=255&(i^e[a]),i=i>>>8^t[u];return-1^i}var u,o,c,s,f,l,m,h,d,p,t=e[0].length,i=e[0][0].length,g=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,i>>24&255,i>>16&255,i>>8&255,255&i,t>>24&255,t>>16&255,t>>8&255,255&t,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(p=r(g,12,29),g[29]=p>>24&255,g[30]=p>>16&255,g[31]=p>>8&255,g[32]=255&p,u=1,o=0,m=0;t>m;m++){for(t-1>m?g.push(0):g.push(1),f=3*i+1+(0===m)&255,l=3*i+1+(0===m)>>8&255,g.push(f),g.push(l),g.push(255&~f),g.push(255&~l),0===m&&g.push(0),h=0;i>h;h++)for(c=0;3>c;c++)f=e[c][m][h],f=f>255?255:0>f?0:Math.round(f),u=(u+f)%65521,o=(o+u)%65521,g.push(f);g.push(0)}return d=(o<<16)+u,g.push(d>>24&255),g.push(d>>16&255),g.push(d>>8&255),g.push(255&d),s=g.length-41,g[33]=s>>24&255,g[34]=s>>16&255,g[35]=s>>8&255,g[36]=255&s,p=r(g,37),g.push(p>>24&255),g.push(p>>16&255),g.push(p>>8&255),g.push(255&p),g.push(0),g.push(0),g.push(0),g.push(0),g.push(73),g.push(69),g.push(78),g.push(68),g.push(174),g.push(66),g.push(96),g.push(130),"data:image/png;base64,"+n(g)},numeric._dim=function(e){for(var n=[];"object"==typeof e;)n.push(e.length),e=e[0];return n},numeric.dim=function(e){var n,r;return"object"==typeof e?(n=e[0],"object"==typeof n?(r=n[0],"object"==typeof r?numeric._dim(e):[e.length,n.length]):[e.length]):[]},numeric.mapreduce=function(e,n){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+n+';\nif(typeof x === "number") { var xi = x; '+e+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+e+";\n    xi = x[i-1];\n    "+e+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+e+"\n}\nreturn accum;")},numeric.mapreduce2=function(e,n){return Function("x","var n = x.length;\nvar i,xi;\n"+n+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+e+";\n}\nreturn accum;")},numeric.same=function e(n,r){var t,i;if(n instanceof Array&&r instanceof Array){if(i=n.length,i!==r.length)return!1;for(t=0;i>t;t++)if(n[t]!==r[t]){if("object"!=typeof n[t])return!1;if(!e(n[t],r[t]))return!1}return!0}return!1},numeric.rep=function(e,n,r){"undefined"==typeof r&&(r=0);var u,t=e[r],i=Array(t);if(r===e.length-1){for(u=t-2;u>=0;u-=2)i[u+1]=n,i[u]=n;return-1===u&&(i[0]=n),i}for(u=t-1;u>=0;u--)i[u]=numeric.rep(e,n,r+1);return i},numeric.dotMMsmall=function(e,n){var r,t,i,u,o,a,c,s,f,l,m;for(u=e.length,o=n.length,a=n[0].length,c=Array(u),r=u-1;r>=0;r--){for(s=Array(a),f=e[r],i=a-1;i>=0;i--){for(l=f[o-1]*n[o-1][i],t=o-2;t>=1;t-=2)m=t-1,l+=f[t]*n[t][i]+f[m]*n[m][i];0===t&&(l+=f[0]*n[0][i]),s[i]=l}c[r]=s}return c},numeric._getCol=function(e,n,r){var i,t=e.length;for(i=t-1;i>0;--i)r[i]=e[i][n],--i,r[i]=e[i][n];0===i&&(r[0]=e[0][n])},numeric.dotMMbig=function(e,n){var c,f,l,h,r=numeric._getCol,t=n.length,i=Array(t),u=e.length,o=n[0].length,a=new Array(u),s=numeric.dotVV;for(--t,--u,f=u;-1!==f;--f)a[f]=Array(o);for(--o,f=o;-1!==f;--f)for(r(n,f,i),l=u;-1!==l;--l)h=0,c=e[l],a[l][f]=s(c,i);return a},numeric.dotMV=function(e,n){var i,r=e.length,u=(n.length,Array(r)),o=numeric.dotVV;for(i=r-1;i>=0;i--)u[i]=o(e[i],n);return u},numeric.dotVM=function(e,n){var t,i,u,o,c,l,m;for(u=e.length,o=n[0].length,c=Array(o),i=o-1;i>=0;i--){for(l=e[u-1]*n[u-1][i],t=u-2;t>=1;t-=2)m=t-1,l+=e[t]*n[t][i]+e[m]*n[m][i];0===t&&(l+=e[0]*n[0][i]),c[i]=l}return c},numeric.dotVV=function(e,n){var r,i,t=e.length,u=e[t-1]*n[t-1];for(r=t-2;r>=1;r-=2)i=r-1,u+=e[r]*n[r]+e[i]*n[i];return 0===r&&(u+=e[0]*n[0]),u},numeric.dot=function(e,n){var r=numeric.dim;switch(1e3*r(e).length+r(n).length){case 2002:return n.length<10?numeric.dotMMsmall(e,n):numeric.dotMMbig(e,n);case 2001:return numeric.dotMV(e,n);case 1002:return numeric.dotVM(e,n);case 1001:return numeric.dotVV(e,n);case 1e3:return numeric.mulVS(e,n);case 1:return numeric.mulSV(e,n);case 0:return e*n;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(e){var n,r,t,o,i=e.length,u=Array(i);for(n=i-1;n>=0;n--){for(o=Array(i),r=n+2,t=i-1;t>=r;t-=2)o[t]=0,o[t-1]=0;for(t>n&&(o[t]=0),o[n]=e[n],t=n-1;t>=1;t-=2)o[t]=0,o[t-1]=0;0===t&&(o[0]=0),u[n]=o}return u},numeric.getDiag=function(e){var r,n=Math.min(e.length,e[0].length),t=Array(n);for(r=n-1;r>=1;--r)t[r]=e[r][r],--r,t[r]=e[r][r];return 0===r&&(t[0]=e[0][0]),t},numeric.identity=function(e){return numeric.diag(numeric.rep([e],1))},numeric.pointwise=function(e,n,r){"undefined"==typeof r&&(r="");var i,o,t=[],u=/\[i\]$/,a="",c=!1;for(i=0;i<e.length;i++)u.test(e[i])?(o=e[i].substring(0,e[i].length-3),a=o):o=e[i],"ret"===o&&(c=!0),t.push(o);return t[e.length]="_s",t[e.length+1]="_k",t[e.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+a+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(c?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+e.join(",")+",_s,_k+1);\n    return ret;\n}\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n    "+n+"\n}\nreturn ret;",Function.apply(null,t)},numeric.pointwise2=function(e,n,r){"undefined"==typeof r&&(r="");var i,o,t=[],u=/\[i\]$/,a="",c=!1;for(i=0;i<e.length;i++)u.test(e[i])?(o=e[i].substring(0,e[i].length-3),a=o):o=e[i],"ret"===o&&(c=!0),t.push(o);return t[e.length]="var _n = "+a+".length;\nvar i"+(c?"":", ret = Array(_n)")+";\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n"+n+"\n}\nreturn ret;",Function.apply(null,t)},numeric._biforeach=function n(e,r,t,i,u){if(i===t.length-1)return void u(e,r);var o,a=t[i];for(o=a-1;o>=0;o--)n("object"==typeof e?e[o]:e,"object"==typeof r?r[o]:r,t,i+1,u)},numeric._biforeach2=function r(e,n,t,i,u){if(i===t.length-1)return u(e,n);var o,a=t[i],c=Array(a);for(o=a-1;o>=0;--o)c[o]=r("object"==typeof e?e[o]:e,"object"==typeof n?n[o]:n,t,i+1,u);return c},numeric._foreach=function t(e,n,r,i){if(r===n.length-1)return void i(e);var u,o=n[r];for(u=o-1;u>=0;u--)t(e[u],n,r+1,i)},numeric._foreach2=function u(e,n,r,t){if(r===n.length-1)return t(e);var i,o=n[r],a=Array(o);for(i=o-1;i>=0;i--)a[i]=u(e[i],n,r+1,t);return a},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var e,n;for(e=0;e<numeric.mathfuns2.length;++e)n=numeric.mathfuns2[e],numeric.ops2[n]=n;for(e in numeric.ops2)if(numeric.ops2.hasOwnProperty(e)){n=numeric.ops2[e];var r,t,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,e)?(i="var "+n+" = Math."+n+";\n",r=function(e,r,t){return e+" = "+n+"("+r+","+t+")"},t=function(e,r){return e+" = "+n+"("+e+","+r+")"}):(r=function(e,r,t){return e+" = "+r+" "+n+" "+t},t=numeric.opseq.hasOwnProperty(e+"eq")?function(e,r){return e+" "+n+"= "+r}:function(e,r){return e+" = "+e+" "+n+" "+r}),numeric[e+"VV"]=numeric.pointwise2(["x[i]","y[i]"],r("ret[i]","x[i]","y[i]"),i),numeric[e+"SV"]=numeric.pointwise2(["x","y[i]"],r("ret[i]","x","y[i]"),i),numeric[e+"VS"]=numeric.pointwise2(["x[i]","y"],r("ret[i]","x[i]","y"),i),numeric[e]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+t("x","y")+"\n}\nreturn x;\n"),numeric[n]=numeric[e],numeric[e+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],t("ret[i]","x[i]"),i),numeric[e+"eqS"]=numeric.pointwise2(["ret[i]","x"],t("ret[i]","x"),i),numeric[e+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+e+"eqV, S = numeric."+e+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(e=0;e<numeric.mathfuns2.length;++e)n=numeric.mathfuns2[e],delete numeric.ops2[n];for(e=0;e<numeric.mathfuns.length;++e)n=numeric.mathfuns[e],numeric.ops1[n]=n;for(e in numeric.ops1)numeric.ops1.hasOwnProperty(e)&&(i="",n=numeric.ops1[e],-1!==numeric.myIndexOf.call(numeric.mathfuns,e)&&Math.hasOwnProperty(n)&&(i="var "+n+" = Math."+n+";\n"),numeric[e+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+n+"(ret[i]);",i),numeric[e+"eq"]=Function("x",'if(typeof x !== "object") return '+n+"x\nvar i;\nvar V = numeric."+e+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[e+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+n+"(x[i]);",i),numeric[e]=Function("x",'if(typeof x !== "object") return '+n+"(x)\nvar i;\nvar V = numeric."+e+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(e=0;e<numeric.mathfuns.length;++e)n=numeric.mathfuns[e],delete numeric.ops1[n];for(e in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(e)&&(n=numeric.mapreducers[e],numeric[e+"V"]=numeric.mapreduce2(n[0],n[1]),numeric[e]=Function("x","s","k",n[1]+'if(typeof x !== "object") {    xi = x;\n'+n[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+e+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+n[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(e,n){return"object"==typeof e?"object"==typeof n?numeric.truncVV(e,n):numeric.truncVS(e,n):"object"==typeof n?numeric.truncSV(e,n):Math.round(e/n)*n},numeric.inv=function(e){var o,a,s,f,l,m,h,e,n=numeric.dim(e),r=Math.abs,t=n[0],i=n[1],u=numeric.clone(e),c=numeric.identity(t);for(m=0;i>m;++m){var d=-1,p=-1;for(l=m;l!==t;++l)h=r(u[l][m]),h>p&&(d=l,p=h);for(a=u[d],u[d]=u[m],u[m]=a,f=c[d],c[d]=c[m],c[m]=f,e=a[m],h=m;h!==i;++h)a[h]/=e;for(h=i-1;-1!==h;--h)f[h]/=e;for(l=t-1;-1!==l;--l)if(l!==m){for(o=u[l],s=c[l],e=o[m],h=m+1;h!==i;++h)o[h]-=a[h]*e;for(h=i-1;h>0;--h)s[h]-=f[h]*e,--h,s[h]-=f[h]*e;0===h&&(s[0]-=f[0]*e)}}return c},numeric.det=function(e){var n=numeric.dim(e);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: det() only works on square matrices");var i,u,o,c,s,f,l,m,r=n[0],t=1,a=numeric.clone(e);for(u=0;r-1>u;u++){for(o=u,i=u+1;r>i;i++)Math.abs(a[i][u])>Math.abs(a[o][u])&&(o=i);for(o!==u&&(l=a[o],a[o]=a[u],a[u]=l,t*=-1),c=a[u],i=u+1;r>i;i++){for(s=a[i],f=s[u]/c[u],o=u+1;r-1>o;o+=2)m=o+1,s[o]-=c[o]*f,s[m]-=c[m]*f;o!==r&&(s[o]-=c[o]*f)}if(0===c[u])return 0;t*=c[u]}return t*a[u][u]},numeric.transpose=function(e){var n,r,o,a,c,t=e.length,i=e[0].length,u=Array(i);for(r=0;i>r;r++)u[r]=Array(t);for(n=t-1;n>=1;n-=2){for(a=e[n],o=e[n-1],r=i-1;r>=1;--r)c=u[r],c[n]=a[r],c[n-1]=o[r],--r,c=u[r],c[n]=a[r],c[n-1]=o[r];0===r&&(c=u[0],c[n]=a[0],c[n-1]=o[0])}if(0===n){for(o=e[0],r=i-1;r>=1;--r)u[r][0]=o[r],--r,u[r][0]=o[r];0===r&&(u[0][0]=o[0])}return u},numeric.negtranspose=function(e){var n,r,o,a,c,t=e.length,i=e[0].length,u=Array(i);for(r=0;i>r;r++)u[r]=Array(t);for(n=t-1;n>=1;n-=2){for(a=e[n],o=e[n-1],r=i-1;r>=1;--r)c=u[r],c[n]=-a[r],c[n-1]=-o[r],--r,c=u[r],c[n]=-a[r],c[n-1]=-o[r];0===r&&(c=u[0],c[n]=-a[0],c[n-1]=-o[0])}if(0===n){for(o=e[0],r=i-1;r>=1;--r)u[r][0]=-o[r],--r,u[r][0]=-o[r];0===r&&(u[0][0]=-o[0])}return u},numeric._random=function o(e,n){var r,u,t=e[n],i=Array(t);if(n===e.length-1){for(u=Math.random,r=t-1;r>=1;r-=2)i[r]=u(),i[r-1]=u();return 0===r&&(i[0]=u()),i}for(r=t-1;r>=0;r--)i[r]=o(e,n+1);return i},numeric.random=function(e){return numeric._random(e,0)},numeric.norm2=function(e){return Math.sqrt(numeric.norm2Squared(e))},numeric.linspace=function(e,n,r){if("undefined"==typeof r&&(r=Math.max(Math.round(n-e)+1,1)),2>r)return 1===r?[e]:[];var t,i=Array(r);for(r--,t=r;t>=0;t--)i[t]=(t*n+(r-t)*e)/r;return i},numeric.getBlock=function(e,n,r){function t(e,u){var o,a=n[u],c=r[u]-a,s=Array(c);if(u===i.length-1){for(o=c;o>=0;o--)s[o]=e[o+a];return s}for(o=c;o>=0;o--)s[o]=t(e[o+a],u+1);return s}var i=numeric.dim(e);return t(e,0)},numeric.setBlock=function(e,n,r,t){function i(e,t,o){var a,c=n[o],s=r[o]-c;if(o===u.length-1)for(a=s;a>=0;a--)e[a+c]=t[a];for(a=s;a>=0;a--)i(e[a+c],t[a],o+1)}var u=numeric.dim(e);return i(e,t,0),e},numeric.getRange=function(e,n,r){var u,o,c,s,t=n.length,i=r.length,a=Array(t);for(u=t-1;-1!==u;--u)for(a[u]=Array(i),c=a[u],s=e[n[u]],o=i-1;-1!==o;--o)c[o]=s[r[o]];return a},numeric.blockMatrix=function(e){var n=numeric.dim(e);if(n.length<4)return numeric.blockMatrix([e]);var i,u,o,a,c,r=n[0],t=n[1];for(i=0,u=0,o=0;r>o;++o)i+=e[o][0].length;for(a=0;t>a;++a)u+=e[0][a][0].length;var s=Array(i);for(o=0;i>o;++o)s[o]=Array(u);var l,m,h,d,p,f=0;for(o=0;r>o;++o){for(l=u,a=t-1;-1!==a;--a)for(c=e[o][a],l-=c[0].length,h=c.length-1;-1!==h;--h)for(p=c[h],m=s[f+h],d=p.length-1;-1!==d;--d)m[l+d]=p[d];f+=e[o][0].length}return s},numeric.tensor=function(e,n){if("number"==typeof e||"number"==typeof n)return numeric.mul(e,n);var r=numeric.dim(e),t=numeric.dim(n);if(1!==r.length||1!==t.length)throw new Error("numeric: tensor product is only defined for vectors");var a,c,s,f,i=r[0],u=t[0],o=Array(i);for(c=i-1;c>=0;c--){for(a=Array(u),f=e[c],s=u-1;s>=3;--s)a[s]=f*n[s],--s,a[s]=f*n[s],--s,a[s]=f*n[s],--s,a[s]=f*n[s];for(;s>=0;)a[s]=f*n[s],--s;o[c]=a}return o},numeric.T=function(e,n){this.x=e,this.y=n},numeric.t=function(e,n){return new numeric.T(e,n)},numeric.Tbinop=function(e,n,r,t,i){numeric.indexOf;if("string"!=typeof i){var o;i="";for(o in numeric)numeric.hasOwnProperty(o)&&(e.indexOf(o)>=0||n.indexOf(o)>=0||r.indexOf(o)>=0||t.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+t+");\n  }\n  return new numeric.T("+r+");\n}\nif(y.y) {\n  return new numeric.T("+n+");\n}\nreturn new numeric.T("+e+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var e=numeric.mul,n=numeric.div;if(this.y){var r=numeric.add(e(this.x,this.x),e(this.y,this.y));return new numeric.T(n(this.x,r),n(numeric.neg(this.y),r))}return new T(n(1,this.x))},numeric.T.prototype.div=function a(e){if(e instanceof numeric.T||(e=new numeric.T(e)),e.y)return this.mul(e.reciprocal());var a=numeric.div;return this.y?new numeric.T(a(this.x,e.x),a(this.y,e.x)):new numeric.T(a(this.x,e.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var e=numeric.transpose,n=this.x,r=this.y;return r?new numeric.T(e(n),e(r)):new numeric.T(e(n))},numeric.T.prototype.transjugate=function(){var e=numeric.transpose,n=this.x,r=this.y;return r?new numeric.T(e(n),numeric.negtranspose(r)):new numeric.T(e(n))},numeric.Tunop=function(e,n,r){return"string"!=typeof r&&(r=""),Function("var x = this;\n"+r+"\nif(x.y) {  "+n+";\n}\n"+e+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var e=this;if("undefined"==typeof e.y)return new numeric.T(numeric.inv(e.x));var r,t,i,s,f,l,m,h,d,p,g,r,t,i,v,y,x,w,b,C,M,n=e.x.length,u=numeric.identity(n),o=numeric.rep([n,n],0),a=numeric.clone(e.x),c=numeric.clone(e.y);for(r=0;n>r;r++){for(x=a[r][r],w=c[r][r],v=x*x+w*w,i=r,t=r+1;n>t;t++)x=a[t][r],w=c[t][r],y=x*x+w*w,y>v&&(i=t,v=y);for(i!==r&&(M=a[r],a[r]=a[i],a[i]=M,M=c[r],c[r]=c[i],c[i]=M,M=u[r],u[r]=u[i],u[i]=M,M=o[r],o[r]=o[i],o[i]=M),s=a[r],f=c[r],h=u[r],d=o[r],x=s[r],w=f[r],t=r+1;n>t;t++)b=s[t],C=f[t],s[t]=(b*x+C*w)/v,f[t]=(C*x-b*w)/v;for(t=0;n>t;t++)b=h[t],C=d[t],h[t]=(b*x+C*w)/v,d[t]=(C*x-b*w)/v;for(t=r+1;n>t;t++){for(l=a[t],m=c[t],p=u[t],g=o[t],x=l[r],w=m[r],i=r+1;n>i;i++)b=s[i],C=f[i],l[i]-=b*x-C*w,m[i]-=C*x+b*w;for(i=0;n>i;i++)b=h[i],C=d[i],p[i]-=b*x-C*w,g[i]-=C*x+b*w}}for(r=n-1;r>0;r--)for(h=u[r],d=o[r],t=r-1;t>=0;t--)for(p=u[t],g=o[t],x=a[t][r],w=c[t][r],i=n-1;i>=0;i--)b=h[i],C=d[i],p[i]-=x*b-w*C,g[i]-=x*C+w*b;return new numeric.T(u,o)},numeric.T.prototype.get=function(e){var i,n=this.x,r=this.y,t=0,u=e.length;if(r){for(;u>t;)i=e[t],n=n[i],r=r[i],t++;return new numeric.T(n,r)}for(;u>t;)i=e[t],n=n[i],t++;return new numeric.T(n)},numeric.T.prototype.set=function(e,n){var u,r=this.x,t=this.y,i=0,o=e.length,a=n.x,c=n.y;if(0===o)return c?this.y=c:t&&(this.y=void 0),this.x=r,this;if(c){for(t||(t=numeric.rep(numeric.dim(r),0),this.y=t);o-1>i;)u=e[i],r=r[u],t=t[u],i++;return u=e[i],r[u]=a,t[u]=c,this}if(t){for(;o-1>i;)u=e[i],r=r[u],t=t[u],i++;return u=e[i],r[u]=a,a instanceof Array?t[u]=numeric.rep(numeric.dim(a),0):t[u]=0,this}for(;o-1>i;)u=e[i],r=r[u],i++;return u=e[i],r[u]=a,this},numeric.T.prototype.getRows=function(e,n){var t,u,r=n-e+1,i=Array(r),o=this.x,a=this.y;for(t=e;n>=t;t++)i[t-e]=o[t];if(a){for(u=Array(r),t=e;n>=t;t++)u[t-e]=a[t];return new numeric.T(i,u)}return new numeric.T(i)},numeric.T.prototype.setRows=function(e,n,r){var t,i=this.x,u=this.y,o=r.x,a=r.y;for(t=e;n>=t;t++)i[t]=o[t-e];if(a)for(u||(u=numeric.rep(numeric.dim(i),0),this.y=u),t=e;n>=t;t++)u[t]=a[t-e];else if(u)for(t=e;n>=t;t++)u[t]=numeric.rep([o[t-e].length],0);return this},numeric.T.prototype.getRow=function(e){var n=this.x,r=this.y;return r?new numeric.T(n[e],r[e]):new numeric.T(n[e])},numeric.T.prototype.setRow=function(e,n){var r=this.x,t=this.y,i=n.x,u=n.y;return r[e]=i,u?(t||(t=numeric.rep(numeric.dim(r),0),this.y=t),t[e]=u):t&&(t=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(e,n){var r=this.x,t=this.y,i=numeric.getBlock;return t?new numeric.T(i(r,e,n),i(t,e,n)):new numeric.T(i(r,e,n))},numeric.T.prototype.setBlock=function(e,n,r){r instanceof numeric.T||(r=new numeric.T(r));var t=this.x,i=this.y,u=numeric.setBlock,o=r.x,a=r.y;return a?(i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),u(t,e,n,o),u(i,e,n,a),this):(u(t,e,n,o),void(i&&u(i,e,n,numeric.rep(numeric.dim(o),0))))},numeric.T.rep=function(e,n){var r=numeric.T;n instanceof r||(n=new r(n));var t=n.x,i=n.y,u=numeric.rep;return i?new r(u(e,t),u(e,i)):new r(u(e,t))},numeric.T.diag=function c(e){e instanceof numeric.T||(e=new numeric.T(e));var n=e.x,r=e.y,c=numeric.diag;return r?new numeric.T(c(n),c(r)):new numeric.T(c(n))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(e){return new numeric.T(numeric.identity(e))},numeric.T.prototype.getDiag=function(){var e=numeric,n=this.x,r=this.y;return r?new e.T(e.getDiag(n),e.getDiag(r)):new e.T(e.getDiag(n))},numeric.house=function(e){var n=numeric.clone(e),r=e[0]>=0?1:-1,t=r*numeric.norm2(e);n[0]+=t;var i=numeric.norm2(n);if(0===i)throw new Error("eig: internal error");return numeric.div(n,i)},numeric.toUpperHessenberg=function(e){var n=numeric.dim(e);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var t,i,u,o,a,s,f,l,m,d,r=n[0],c=numeric.clone(e),h=numeric.identity(r);for(i=0;r-2>i;i++){for(o=Array(r-i-1),t=i+1;r>t;t++)o[t-i-1]=c[t][i];if(numeric.norm2(o)>0){for(a=numeric.house(o),s=numeric.getBlock(c,[i+1,i],[r-1,r-1]),f=numeric.tensor(a,numeric.dot(a,s)),t=i+1;r>t;t++)for(l=c[t],m=f[t-i-1],u=i;r>u;u++)l[u]-=2*m[u-i];for(s=numeric.getBlock(c,[0,i+1],[r-1,r-1]),f=numeric.tensor(numeric.dot(s,a),a),t=0;r>t;t++)for(l=c[t],m=f[t],u=i+1;r>u;u++)l[u]-=2*m[u-i-1];for(s=Array(r-i-1),t=i+1;r>t;t++)s[t-i-1]=h[t];for(f=numeric.tensor(a,numeric.dot(a,s)),t=i+1;r>t;t++)for(d=h[t],m=f[t-i-1],u=0;r>u;u++)d[u]-=2*m[u]}}return{H:c,Q:h}},numeric.epsilon=2.220446049250313e-16,numeric.QRFrancis=function(e,n){"undefined"==typeof n&&(n=1e4),e=numeric.clone(e);var u,o,a,c,s,f,l,m,h,p,g,v,y,x,w,b,C,M,t=(numeric.clone(e),numeric.dim(e)),i=t[0],d=numeric.identity(i);if(3>i)return{Q:d,B:[[0,i-1]]};var k=numeric.epsilon;for(M=0;n>M;M++){for(b=0;i-1>b;b++)if(Math.abs(e[b+1][b])<k*(Math.abs(e[b][b])+Math.abs(e[b+1][b+1]))){var T=numeric.QRFrancis(numeric.getBlock(e,[0,0],[b,b]),n),I=numeric.QRFrancis(numeric.getBlock(e,[b+1,b+1],[i-1,i-1]),n);for(v=Array(b+1),w=0;b>=w;w++)v[w]=d[w];for(y=numeric.dot(T.Q,v),w=0;b>=w;w++)d[w]=y[w];for(v=Array(i-b-1),w=b+1;i>w;w++)v[w-b-1]=d[w];for(y=numeric.dot(I.Q,v),w=b+1;i>w;w++)d[w]=y[w-b-1];return{Q:d,B:T.B.concat(numeric.add(I.B,b+1))}}if(a=e[i-2][i-2],c=e[i-2][i-1],s=e[i-1][i-2],f=e[i-1][i-1],m=a+f,l=a*f-c*s,h=numeric.getBlock(e,[0,0],[2,2]),m*m>=4*l){var D,P;D=.5*(m+Math.sqrt(m*m-4*l)),P=.5*(m-Math.sqrt(m*m-4*l)),h=numeric.add(numeric.sub(numeric.dot(h,h),numeric.mul(h,D+P)),numeric.diag(numeric.rep([3],D*P)))}else h=numeric.add(numeric.sub(numeric.dot(h,h),numeric.mul(h,m)),numeric.diag(numeric.rep([3],l)));for(u=[h[0][0],h[1][0],h[2][0]],o=numeric.house(u),v=[e[0],e[1],e[2]],y=numeric.tensor(o,numeric.dot(o,v)),w=0;3>w;w++)for(g=e[w],x=y[w],C=0;i>C;C++)g[C]-=2*x[C];for(v=numeric.getBlock(e,[0,0],[i-1,2]),y=numeric.tensor(numeric.dot(v,o),o),w=0;i>w;w++)for(g=e[w],x=y[w],C=0;3>C;C++)g[C]-=2*x[C];for(v=[d[0],d[1],d[2]],y=numeric.tensor(o,numeric.dot(o,v)),w=0;3>w;w++)for(p=d[w],x=y[w],C=0;i>C;C++)p[C]-=2*x[C];var S;for(b=0;i-2>b;b++){for(C=b;b+1>=C;C++)if(Math.abs(e[C+1][C])<k*(Math.abs(e[C][C])+Math.abs(e[C+1][C+1]))){var T=numeric.QRFrancis(numeric.getBlock(e,[0,0],[C,C]),n),I=numeric.QRFrancis(numeric.getBlock(e,[C+1,C+1],[i-1,i-1]),n);for(v=Array(C+1),w=0;C>=w;w++)v[w]=d[w];for(y=numeric.dot(T.Q,v),w=0;C>=w;w++)d[w]=y[w];for(v=Array(i-C-1),w=C+1;i>w;w++)v[w-C-1]=d[w];for(y=numeric.dot(I.Q,v),w=C+1;i>w;w++)d[w]=y[w-C-1];return{Q:d,B:T.B.concat(numeric.add(I.B,C+1))}}for(S=Math.min(i-1,b+3),u=Array(S-b),w=b+1;S>=w;w++)u[w-b-1]=e[w][b];for(o=numeric.house(u),v=numeric.getBlock(e,[b+1,b],[S,i-1]),y=numeric.tensor(o,numeric.dot(o,v)),w=b+1;S>=w;w++)for(g=e[w],x=y[w-b-1],C=b;i>C;C++)g[C]-=2*x[C-b];for(v=numeric.getBlock(e,[0,b+1],[i-1,S]),y=numeric.tensor(numeric.dot(v,o),o),w=0;i>w;w++)for(g=e[w],x=y[w],C=b+1;S>=C;C++)g[C]-=2*x[C-b-1];for(v=Array(S-b),w=b+1;S>=w;w++)v[w-b-1]=d[w];for(y=numeric.tensor(o,numeric.dot(o,v)),w=b+1;S>=w;w++)for(p=d[w],x=y[w-b-1],C=0;i>C;C++)p[C]-=2*x[C]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(e,n){var o,a,m,d,p,g,v,y,x,w,b,C,M,k,T,I,D,r=numeric.toUpperHessenberg(e),t=numeric.QRFrancis(r.H,n),i=numeric.T,u=e.length,s=t.B,f=numeric.dot(t.Q,numeric.dot(r.H,numeric.transpose(t.Q))),l=new i(numeric.dot(t.Q,r.Q)),h=s.length,P=Math.sqrt;for(a=0;h>a;a++)if(o=s[a][0],o!==s[a][1]){if(d=o+1,p=f[o][o],g=f[o][d],v=f[d][o],y=f[d][d],0===g&&0===v)continue;x=-p-y,w=p*y-g*v,b=x*x-4*w,b>=0?(C=0>x?-.5*(x-P(b)):-.5*(x+P(b)),I=(p-C)*(p-C)+g*g,D=v*v+(y-C)*(y-C),
I>D?(I=P(I),k=(p-C)/I,T=g/I):(D=P(D),k=v/D,T=(y-C)/D),m=new i([[T,-k],[k,T]]),l.setRows(o,d,m.dot(l.getRows(o,d)))):(C=-.5*x,M=.5*P(-b),I=(p-C)*(p-C)+g*g,D=v*v+(y-C)*(y-C),I>D?(I=P(I+M*M),k=(p-C)/I,T=g/I,C=0,M/=I):(D=P(D+M*M),k=v/D,T=(y-C)/D,C=M/D,M=0),m=new i([[T,-k],[k,T]],[[C,M],[M,-C]]),l.setRows(o,d,m.dot(l.getRows(o,d))))}var S=l.dot(e).dot(l.transjugate()),u=e.length,A=numeric.T.identity(u);for(d=0;u>d;d++)if(d>0)for(a=d-1;a>=0;a--){var j=S.get([a,a]),O=S.get([d,d]);numeric.neq(j.x,O.x)||numeric.neq(j.y,O.y)?(C=S.getRow(a).getBlock([a],[d-1]),M=A.getRow(d).getBlock([a],[d-1]),A.set([d,a],S.get([a,d]).neg().sub(C.dot(M)).div(j.sub(O)))):A.setRow(d,A.getRow(a))}for(d=0;u>d;d++)C=A.getRow(d),A.setRow(d,C.div(C.norm2()));return A=A.transpose(),A=l.transjugate().dot(A),{lambda:S.getDiag(),E:A}},numeric.ccsSparse=function(e){var r,t,i,u,n=e.length,o=[];for(i=n-1;-1!==i;--i){t=e[i];for(u in t){for(u=parseInt(u);u>=o.length;)o[o.length]=0;0!==t[u]&&o[u]++}}var r=o.length,a=Array(r+1);for(a[0]=0,i=0;r>i;++i)a[i+1]=a[i]+o[i];var c=Array(a[r]),s=Array(a[r]);for(i=n-1;-1!==i;--i){t=e[i];for(u in t)0!==t[u]&&(o[u]--,c[a[u]+o[u]]=i,s[a[u]+o[u]]=t[u])}return[a,c,s]},numeric.ccsFull=function(e){var a,c,s,f,n=e[0],r=e[1],t=e[2],i=numeric.ccsDim(e),u=i[0],o=i[1],m=numeric.rep([u,o],0);for(a=0;o>a;a++)for(s=n[a],f=n[a+1],c=s;f>c;++c)m[r[c]][a]=t[c];return m},numeric.ccsTSolve=function(e,n,r,t,i){function u(e){var n;if(0===r[e]){for(r[e]=1,n=o[e];n<o[e+1];++n)u(a[n]);i[l]=e,++l}}var o=e[0],a=e[1],c=e[2],s=o.length-1,f=Math.max,l=0;"undefined"==typeof t&&(r=numeric.rep([s],0)),"undefined"==typeof t&&(t=numeric.linspace(0,r.length-1)),"undefined"==typeof i&&(i=[]);var m,h,d,p,g,v,w;for(m=t.length-1;-1!==m;--m)u(t[m]);for(i.length=l,m=i.length-1;-1!==m;--m)r[i[m]]=0;for(m=t.length-1;-1!==m;--m)h=t[m],r[h]=n[h];for(m=i.length-1;-1!==m;--m){for(h=i[m],d=o[h],p=f(o[h+1],d),g=d;g!==p;++g)if(a[g]===h){r[h]/=c[g];break}for(w=r[h],g=d;g!==p;++g)v=a[g],v!==h&&(r[v]-=w*c[g])}return r},numeric.ccsDFS=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS.prototype.dfs=function(e,n,r,t,i,u){var a,m,h,o=0,c=i.length,s=this.k,f=this.k1,l=this.j;if(0===t[e])for(t[e]=1,l[0]=e,s[0]=m=n[e],f[0]=h=n[e+1];;)if(m>=h){if(i[c]=l[o],0===o)return;++c,--o,m=s[o],h=f[o]}else a=u[r[m]],0===t[a]?(t[a]=1,s[o]=m,++o,l[o]=a,m=n[a],f[o]=h=n[a+1]):++m},numeric.ccsLPSolve=function(e,n,r,t,i,u,o){var p,g,v,y,w,b,C,M,I,a=e[0],c=e[1],s=e[2],m=(a.length-1,n[0]),h=n[1],d=n[2];for(g=m[i],v=m[i+1],t.length=0,p=g;v>p;++p)o.dfs(u[h[p]],a,c,r,t,u);for(p=t.length-1;-1!==p;--p)r[t[p]]=0;for(p=g;p!==v;++p)y=u[h[p]],r[y]=d[p];for(p=t.length-1;-1!==p;--p){for(y=t[p],w=a[y],b=a[y+1],C=w;b>C;++C)if(u[c[C]]===y){r[y]/=s[C];break}for(I=r[y],C=w;b>C;++C)M=u[c[C]],M!==y&&(r[M]-=I*s[C])}return r},numeric.ccsLUP1=function(e,n){var h,d,p,y,x,w,b,r=e[0].length-1,t=[numeric.rep([r+1],0),[],[]],i=[numeric.rep([r+1],0),[],[]],u=t[0],o=t[1],a=t[2],c=i[0],s=i[1],f=i[2],l=numeric.rep([r],0),m=numeric.rep([r],0),M=numeric.ccsLPSolve,T=(Math.max,Math.abs),I=numeric.linspace(0,r-1),D=numeric.linspace(0,r-1),P=new numeric.ccsDFS(r);for("undefined"==typeof n&&(n=1),h=0;r>h;++h){for(M(t,e,l,m,h,D,P),y=-1,x=-1,d=m.length-1;-1!==d;--d)p=m[d],h>=p||(w=T(l[p]),w>y&&(x=p,y=w));for(T(l[h])<n*y&&(d=I[h],y=I[x],I[h]=y,D[y]=h,I[x]=d,D[d]=x,y=l[h],l[h]=l[x],l[x]=y),y=u[h],x=c[h],b=l[h],o[y]=I[h],a[y]=1,++y,d=m.length-1;-1!==d;--d)p=m[d],w=l[p],m[d]=0,l[p]=0,h>=p?(s[x]=p,f[x]=w,++x):(o[y]=I[p],a[y]=w/b,++y);u[h+1]=y,c[h+1]=x}for(d=o.length-1;-1!==d;--d)o[d]=D[o[d]];return{L:t,U:i,P:I,Pinv:D}},numeric.ccsDFS0=function(e){this.k=Array(e),this.k1=Array(e),this.j=Array(e)},numeric.ccsDFS0.prototype.dfs=function(e,n,r,t,i,u,o){var c,h,d,a=0,s=i.length,f=this.k,l=this.k1,m=this.j;if(0===t[e])for(t[e]=1,m[0]=e,f[0]=h=n[u[e]],l[0]=d=n[u[e]+1];;){if(isNaN(h))throw new Error("Ow!");if(h>=d){if(i[s]=u[m[a]],0===a)return;++s,--a,h=f[a],d=l[a]}else c=r[h],0===t[c]?(t[c]=1,f[a]=h,++a,m[a]=c,c=u[c],h=n[c],l[a]=d=n[c+1]):++h}},numeric.ccsLPSolve0=function(e,n,r,t,i,u,o,a){var g,v,y,x,b,C,M,k,D,c=e[0],s=e[1],f=e[2],h=(c.length-1,n[0]),d=n[1],p=n[2];for(v=h[i],y=h[i+1],t.length=0,g=v;y>g;++g)a.dfs(d[g],c,s,r,t,u,o);for(g=t.length-1;-1!==g;--g)x=t[g],r[o[x]]=0;for(g=v;g!==y;++g)x=d[g],r[x]=p[g];for(g=t.length-1;-1!==g;--g){for(x=t[g],k=o[x],b=c[x],C=c[x+1],M=b;C>M;++M)if(s[M]===k){r[k]/=f[M];break}for(D=r[k],M=b;C>M;++M)r[s[M]]-=D*f[M];r[k]=D}},numeric.ccsLUP0=function(e,n){var h,d,p,y,x,w,b,r=e[0].length-1,t=[numeric.rep([r+1],0),[],[]],i=[numeric.rep([r+1],0),[],[]],u=t[0],o=t[1],a=t[2],c=i[0],s=i[1],f=i[2],l=numeric.rep([r],0),m=numeric.rep([r],0),M=numeric.ccsLPSolve0,T=(Math.max,Math.abs),I=numeric.linspace(0,r-1),D=numeric.linspace(0,r-1),P=new numeric.ccsDFS0(r);for("undefined"==typeof n&&(n=1),h=0;r>h;++h){for(M(t,e,l,m,h,D,I,P),y=-1,x=-1,d=m.length-1;-1!==d;--d)p=m[d],h>=p||(w=T(l[I[p]]),w>y&&(x=p,y=w));for(T(l[I[h]])<n*y&&(d=I[h],y=I[x],I[h]=y,D[y]=h,I[x]=d,D[d]=x),y=u[h],x=c[h],b=l[I[h]],o[y]=I[h],a[y]=1,++y,d=m.length-1;-1!==d;--d)p=m[d],w=l[I[p]],m[d]=0,l[I[p]]=0,h>=p?(s[x]=p,f[x]=w,++x):(o[y]=I[p],a[y]=w/b,++y);u[h+1]=y,c[h+1]=x}for(d=o.length-1;-1!==d;--d)o[d]=D[o[d]];return{L:t,U:i,P:I,Pinv:D}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(e){return[numeric.sup(e[1])+1,e[0].length-1]},numeric.ccsGetBlock=function(e,n,r){var t=numeric.ccsDim(e),i=t[0],u=t[1];"undefined"==typeof n?n=numeric.linspace(0,i-1):"number"==typeof n&&(n=[n]),"undefined"==typeof r?r=numeric.linspace(0,u-1):"number"==typeof r&&(r=[r]);var o,f,m,h,d,s=n.length,l=r.length,p=numeric.rep([u],0),g=[],v=[],y=[p,g,v],x=e[0],w=e[1],b=e[2],C=numeric.rep([i],0),M=0,k=numeric.rep([i],0);for(f=0;l>f;++f){h=r[f];var T=x[h],I=x[h+1];for(o=T;I>o;++o)m=w[o],k[m]=1,C[m]=b[o];for(o=0;s>o;++o)d=n[o],k[d]&&(g[M]=o,v[M]=C[n[o]],++M);for(o=T;I>o;++o)m=w[o],k[m]=0;p[f+1]=M}return y},numeric.ccsDot=function(e,n){var w,b,C,M,k,T,I,D,P,S,A,r=e[0],t=e[1],i=e[2],u=n[0],o=n[1],a=n[2],c=numeric.ccsDim(e),s=numeric.ccsDim(n),f=c[0],m=(c[1],s[1]),h=numeric.rep([f],0),d=numeric.rep([f],0),p=Array(f),g=numeric.rep([m],0),v=[],y=[],x=[g,v,y];for(C=0;C!==m;++C){for(M=u[C],k=u[C+1],P=0,b=M;k>b;++b)for(S=o[b],A=a[b],T=r[S],I=r[S+1],w=T;I>w;++w)D=t[w],0===d[D]&&(p[P]=D,d[D]=1,P+=1),h[D]=h[D]+i[w]*A;for(M=g[C],k=M+P,g[C+1]=k,b=P-1;-1!==b;--b)A=M+b,w=p[b],v[A]=w,y[A]=h[w],d[w]=0,h[w]=0;g[C+1]=g[C]+P}return x},numeric.ccsLUPSolve=function(e,n){var r=e.L,t=e.U,u=(e.P,n[0]),o=!1;"object"!=typeof u&&(n=[[0,n.length],numeric.linspace(0,n.length-1),n],u=n[0],o=!0);var x,w,b,C,M,k,a=n[1],c=n[2],s=r[0].length-1,f=u.length-1,l=numeric.rep([s],0),m=Array(s),h=numeric.rep([s],0),d=Array(s),p=numeric.rep([f+1],0),g=[],v=[],y=numeric.ccsTSolve,T=0;for(x=0;f>x;++x){for(M=0,b=u[x],C=u[x+1],w=b;C>w;++w)k=e.Pinv[a[w]],d[M]=k,h[k]=c[w],++M;for(d.length=M,y(r,h,l,d,m),w=d.length-1;-1!==w;--w)h[d[w]]=0;if(y(t,l,h,m,d),o)return h;for(w=m.length-1;-1!==w;--w)l[m[w]]=0;for(w=d.length-1;-1!==w;--w)k=d[w],g[T]=k,v[T]=h[k],h[k]=0,++T;p[x+1]=T}return[p,g,v]},numeric.ccsbinop=function(e,n){return"undefined"==typeof n&&(n=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+n+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+e+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(e){var f,n=e[0],r=e[1],t=e[2],i=numeric.sup(r)+1,u=n.length,o=numeric.rep([i],0),a=Array(u),c=Array(u),s=numeric.rep([i],0);for(f=0;u>f;++f)s[r[f]]++;for(f=0;i>f;++f)o[f+1]=o[f]+s[f];var m,h,l=o.slice(0);for(f=0;u>f;++f)h=r[f],m=l[h],a[m]=n[f],c[m]=t[f],l[h]=l[h]+1;return[o,a,c]},numeric.ccsGather=function(e){var s,f,l,m,h,n=e[0],r=e[1],t=e[2],i=n.length-1,u=r.length,o=Array(u),a=Array(u),c=Array(u);for(h=0,s=0;i>s;++s)for(l=n[s],m=n[s+1],f=l;f!==m;++f)a[h]=s,o[h]=r[f],c[h]=t[f],++h;return[o,a,c]},numeric.sdim=function s(e,n,r){if("undefined"==typeof n&&(n=[]),"object"!=typeof e)return n;"undefined"==typeof r&&(r=0),r in n||(n[r]=0),e.length>n[r]&&(n[r]=e.length);var t;for(t in e)e.hasOwnProperty(t)&&s(e[t],n,r+1);return n},numeric.sclone=function f(e,n,r){"undefined"==typeof n&&(n=0),"undefined"==typeof r&&(r=numeric.sdim(e).length);var t,i=Array(e.length);if(n===r-1){for(t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}for(t in e)e.hasOwnProperty(t)&&(i[t]=f(e[t],n+1,r));return i},numeric.sdiag=function(e){var r,i,n=e.length,t=Array(n);for(r=n-1;r>=1;r-=2)i=r-1,t[r]=[],t[r][r]=e[r],t[i]=[],t[i][i]=e[i];return 0===r&&(t[0]=[],t[0][0]=e[r]),t},numeric.sidentity=function(e){return numeric.sdiag(numeric.rep([e],1))},numeric.stranspose=function(e){var t,i,u,n=[];e.length;for(t in e)if(e.hasOwnProperty(t)){u=e[t];for(i in u)u.hasOwnProperty(i)&&("object"!=typeof n[i]&&(n[i]=[]),n[i][t]=u[i])}return n},numeric.sLUP=function(e,n){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(e,n){var o,a,c,s,f,l,h,r=e.length,i=(n.length,numeric.stranspose(n)),u=i.length,m=Array(r);for(c=r-1;c>=0;c--){for(h=[],o=e[c],f=u-1;f>=0;f--){l=0,a=i[f];for(s in o)o.hasOwnProperty(s)&&s in a&&(l+=o[s]*a[s]);l&&(h[f]=l)}m[c]=h}return m},numeric.sdotMV=function(e,n){var t,i,u,a,r=e.length,o=Array(r);for(i=r-1;i>=0;i--){t=e[i],a=0;for(u in t)t.hasOwnProperty(u)&&n[u]&&(a+=t[u]*n[u]);a&&(o[i]=a)}return o},numeric.sdotVM=function(e,n){var r,t,i,u,o=[];for(r in e)if(e.hasOwnProperty(r)){i=n[r],u=e[r];for(t in i)i.hasOwnProperty(t)&&(o[t]||(o[t]=0),o[t]+=u*i[t])}return o},numeric.sdotVV=function(e,n){var r,t=0;for(r in e)e[r]&&n[r]&&(t+=e[r]*n[r]);return t},numeric.sdot=function(e,n){var r=numeric.sdim(e).length,t=numeric.sdim(n).length,i=1e3*r+t;switch(i){case 0:return e*n;case 1001:return numeric.sdotVV(e,n);case 2001:return numeric.sdotMV(e,n);case 1002:return numeric.sdotVM(e,n);case 2002:return numeric.sdotMM(e,n);default:throw new Error("numeric.sdot not implemented for tensors of order "+r+" and "+t)}},numeric.sscatter=function(e){var r,t,i,a,n=e[0].length,u=e.length,o=[];for(t=n-1;t>=0;--t)if(e[u-1][t]){for(a=o,i=0;u-2>i;i++)r=e[i][t],a[r]||(a[r]=[]),a=a[r];a[e[i][t]]=e[i+1][t]}return o},numeric.sgather=function l(e,n,r){"undefined"==typeof n&&(n=[]),"undefined"==typeof r&&(r=[]);var t,i,u;t=r.length;for(i in e)if(e.hasOwnProperty(i))if(r[t]=parseInt(i),u=e[i],"number"==typeof u){if(u){if(0===n.length)for(i=t+1;i>=0;--i)n[i]=[];for(i=t;i>=0;--i)n[i].push(r[i]);n[t+1].push(u)}}else l(u,n,r);return r.length>t&&r.pop(),n},numeric.cLU=function(e){var o,a,c,s,f,l,n=e[0],r=e[1],t=e[2],i=n.length,u=0;for(o=0;i>o;o++)n[o]>u&&(u=n[o]);u++;var g,v,y,m=Array(u),h=Array(u),d=numeric.rep([u],1/0),p=numeric.rep([u],-(1/0));for(c=0;i>c;c++)o=n[c],a=r[c],a<d[o]&&(d[o]=a),a>p[o]&&(p[o]=a);for(o=0;u-1>o;o++)p[o]>p[o+1]&&(p[o+1]=p[o]);for(o=u-1;o>=1;o--)d[o]<d[o-1]&&(d[o-1]=d[o]);var x=0,w=0;for(o=0;u>o;o++)h[o]=numeric.rep([p[o]-d[o]+1],0),m[o]=numeric.rep([o-d[o]],0),x+=o-d[o]+1,w+=p[o]-o+1;for(c=0;i>c;c++)o=n[c],h[o][r[c]-d[o]]=t[c];for(o=0;u-1>o;o++)for(s=o-d[o],g=h[o],a=o+1;d[a]<=o&&u>a;a++)if(f=o-d[a],l=p[o]-o,v=h[a],y=v[f]/g[s],y){for(c=1;l>=c;c++)v[c+f]-=y*g[c+s];m[a][o-d[a]]=y}var i,T,I,g=[],v=[],b=[],C=[],M=[],k=[];for(i=0,T=0,o=0;u>o;o++){for(s=d[o],f=p[o],I=h[o],a=o;f>=a;a++)I[a-s]&&(g[i]=o,v[i]=a,b[i]=I[a-s],i++);for(I=m[o],a=s;o>a;a++)I[a-s]&&(C[T]=o,M[T]=a,k[T]=I[a-s],T++);C[T]=o,M[T]=o,k[T]=1,T++}return{U:[g,v,b],L:[C,M,k]}},numeric.cLUsolve=function(e,n){var d,g,r=e.L,t=e.U,i=numeric.clone(n),u=r[0],o=r[1],a=r[2],c=t[0],s=t[1],f=t[2],l=c.length,h=(u.length,i.length);for(g=0,d=0;h>d;d++){for(;o[g]<d;)i[d]-=a[g]*i[o[g]],g++;g++}for(g=l-1,d=h-1;d>=0;d--){for(;s[g]>d;)i[d]-=f[g]*i[s[g]],g--;i[d]/=f[g],g--}return i},numeric.cgrid=function(e,n){"number"==typeof e&&(e=[e,e]);var t,i,u,r=numeric.rep(e,-1);if("function"!=typeof n)switch(n){case"L":n=function(n,r){return n>=e[0]/2||r<e[1]/2};break;default:n=function(e,n){return!0}}for(u=0,t=1;t<e[0]-1;t++)for(i=1;i<e[1]-1;i++)n(t,i)&&(r[t][i]=u,u++);return r},numeric.cdelsq=function(e){var u,o,a,c,s,n=[[-1,0],[0,-1],[0,1],[1,0]],r=numeric.dim(e),t=r[0],i=r[1],f=[],l=[],m=[];for(u=1;t-1>u;u++)for(o=1;i-1>o;o++)if(!(e[u][o]<0)){for(a=0;4>a;a++)c=u+n[a][0],s=o+n[a][1],e[c][s]<0||(f.push(e[u][o]),l.push(e[c][s]),m.push(-1));f.push(e[u][o]),l.push(e[u][o]),m.push(4)}return[f,l,m]},numeric.cdotMV=function(e,n){var r,o,c,t=e[0],i=e[1],u=e[2],a=t.length;for(c=0,o=0;a>o;o++)t[o]>c&&(c=t[o]);for(c++,r=numeric.rep([c],0),o=0;a>o;o++)r[t[o]]+=u[o]*n[i[o]];return r},numeric.Spline=function(e,n,r,t,i){this.x=e,this.yl=n,this.yr=r,this.kl=t,this.kr=i},numeric.Spline.prototype._at=function(e,n){var e,a,c,s,r=this.x,t=this.yl,i=this.yr,u=this.kl,o=this.kr,f=numeric.add,l=numeric.sub,m=numeric.mul;a=l(m(u[n],r[n+1]-r[n]),l(i[n+1],t[n])),c=f(m(o[n+1],r[n]-r[n+1]),l(i[n+1],t[n])),s=(e-r[n])/(r[n+1]-r[n]);var h=s*(1-s);return f(f(f(m(1-s,t[n]),m(s,i[n+1])),m(a,h*(1-s))),m(c,h*s))},numeric.Spline.prototype.at=function(e){if("number"==typeof e){var t,i,u,n=this.x,r=n.length,o=Math.floor;for(t=0,i=r-1;i-t>1;)u=o((t+i)/2),n[u]<=e?t=u:i=u;return this._at(e,t)}var f,r=e.length,l=Array(r);for(f=r-1;-1!==f;--f)l[f]=this.at(e[f]);return l},numeric.Spline.prototype.diff=function(){var o,a,c,e=this.x,n=this.yl,r=this.yr,t=this.kl,i=this.kr,u=n.length,s=t,f=i,l=Array(u),m=Array(u),h=numeric.add,d=numeric.mul,p=numeric.div,g=numeric.sub;for(o=u-1;-1!==o;--o)a=e[o+1]-e[o],c=g(r[o+1],n[o]),l[o]=p(h(d(c,6),d(t[o],-4*a),d(i[o+1],-2*a)),a*a),m[o+1]=p(h(d(c,-6),d(t[o],2*a),d(i[o+1],4*a)),a*a);return new numeric.Spline(e,s,f,l,m)},numeric.Spline.prototype.roots=function(){function e(e){return e*e}var r=[],t=this.x,i=this.yl,u=this.yr,o=this.kl,a=this.kr;"number"==typeof i[0]&&(i=[i],u=[u],o=[o],a=[a]);var f,l,m,g,v,y,x,w,b,C,M,k,T,I,D,P,S,A,j,O,E,F,_,L,c=i.length,s=t.length-1,r=Array(c),V=Math.sqrt;for(f=0;f!==c;++f){for(g=i[f],v=u[f],y=o[f],x=a[f],w=[],l=0;l!==s;l++){for(l>0&&v[l]*g[l]<0&&w.push(t[l]),P=t[l+1]-t[l],S=t[l],M=g[l],k=v[l+1],b=y[l]/P,C=x[l+1]/P,D=e(b-C+3*(M-k))+12*C*M,T=C+3*M+2*b-3*k,I=3*(C+b+2*(M-k)),0>=D?(j=T/I,A=j>t[l]&&j<t[l+1]?[t[l],j,t[l+1]]:[t[l],t[l+1]]):(j=(T-V(D))/I,O=(T+V(D))/I,A=[t[l]],j>t[l]&&j<t[l+1]&&A.push(j),O>t[l]&&O<t[l+1]&&A.push(O),A.push(t[l+1])),F=A[0],j=this._at(F,l),m=0;m<A.length-1;m++)if(_=A[m+1],O=this._at(_,l),0!==j)if(0===O||j*O>0)F=_,j=O;else{for(var B=0;L=(j*_-O*F)/(j-O),!(F>=L||L>=_);)if(E=this._at(L,l),E*O>0)_=L,O=E,-1===B&&(j*=.5),B=-1;else{if(!(E*j>0))break;F=L,j=E,1===B&&(O*=.5),B=1}w.push(L),F=A[m+1],j=this._at(F,l)}else w.push(F),F=_,j=O;0===O&&w.push(_)}r[f]=w}return"number"==typeof this.yl[0]?r[0]:r},numeric.spline=function(e,n,r,t){var c,i=e.length,u=[],o=[],a=[],s=numeric.sub,f=numeric.mul,l=numeric.add;for(c=i-2;c>=0;c--)o[c]=e[c+1]-e[c],a[c]=s(n[c+1],n[c]);("string"==typeof r||"string"==typeof t)&&(r=t="periodic");var m=[[],[],[]];switch(typeof r){case"undefined":u[0]=f(3/(o[0]*o[0]),a[0]),m[0].push(0,0),m[1].push(0,1),m[2].push(2/o[0],1/o[0]);break;case"string":u[0]=l(f(3/(o[i-2]*o[i-2]),a[i-2]),f(3/(o[0]*o[0]),a[0])),m[0].push(0,0,0),m[1].push(i-2,0,1),m[2].push(1/o[i-2],2/o[i-2]+2/o[0],1/o[0]);break;default:u[0]=r,m[0].push(0),m[1].push(0),m[2].push(1)}for(c=1;i-1>c;c++)u[c]=l(f(3/(o[c-1]*o[c-1]),a[c-1]),f(3/(o[c]*o[c]),a[c])),m[0].push(c,c,c),m[1].push(c-1,c,c+1),m[2].push(1/o[c-1],2/o[c-1]+2/o[c],1/o[c]);switch(typeof t){case"undefined":u[i-1]=f(3/(o[i-2]*o[i-2]),a[i-2]),m[0].push(i-1,i-1),m[1].push(i-2,i-1),m[2].push(1/o[i-2],2/o[i-2]);break;case"string":m[1][m[1].length-1]=0;break;default:u[i-1]=t,m[0].push(i-1),m[1].push(i-1),m[2].push(1)}u="number"!=typeof u[0]?numeric.transpose(u):[u];var h=Array(u.length);if("string"==typeof r)for(c=h.length-1;-1!==c;--c)h[c]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(m)),u[c]),h[c][i-1]=h[c][0];else for(c=h.length-1;-1!==c;--c)h[c]=numeric.cLUsolve(numeric.cLU(m),u[c]);return h="number"==typeof n[0]?h[0]:numeric.transpose(h),new numeric.Spline(e,n,n,h,h)},numeric.fftpow2=function m(e,n){var r=e.length;if(1!==r){var u,o,t=Math.cos,i=Math.sin,a=Array(r/2),c=Array(r/2),s=Array(r/2),f=Array(r/2);for(o=r/2,u=r-1;-1!==u;--u)--o,s[o]=e[u],f[o]=n[u],--u,a[o]=e[u],c[o]=n[u];m(a,c),m(s,f),o=r/2;var l,d,p,h=-6.283185307179586/r;for(u=r-1;-1!==u;--u)--o,-1===o&&(o=r/2-1),l=h*u,d=t(l),p=i(l),e[u]=a[o]+d*s[o]-p*f[o],n[u]=c[o]+d*f[o]+p*s[o]}},numeric._ifftpow2=function h(e,n){var r=e.length;if(1!==r){var u,o,t=Math.cos,i=Math.sin,a=Array(r/2),c=Array(r/2),s=Array(r/2),f=Array(r/2);for(o=r/2,u=r-1;-1!==u;--u)--o,s[o]=e[u],f[o]=n[u],--u,a[o]=e[u],c[o]=n[u];h(a,c),h(s,f),o=r/2;var l,d,p,m=6.283185307179586/r;for(u=r-1;-1!==u;--u)--o,-1===o&&(o=r/2-1),l=m*u,d=t(l),p=i(l),e[u]=a[o]+d*s[o]-p*f[o],n[u]=c[o]+d*f[o]+p*s[o]}},numeric.ifftpow2=function(e,n){numeric._ifftpow2(e,n),numeric.diveq(e,e.length),numeric.diveq(n,n.length)},numeric.convpow2=function(e,n,r,t){numeric.fftpow2(e,n),numeric.fftpow2(r,t);var i,o,a,c,s,u=e.length;for(i=u-1;-1!==i;--i)o=e[i],c=n[i],a=r[i],s=t[i],e[i]=o*a-c*s,n[i]=o*s+c*a;numeric.ifftpow2(e,n)},numeric.T.prototype.fft=function(){var l,h,e=this.x,n=this.y,r=e.length,t=Math.log,i=t(2),u=Math.ceil(t(2*r-1)/i),o=Math.pow(2,u),a=numeric.rep([o],0),c=numeric.rep([o],0),s=Math.cos,f=Math.sin,m=-3.141592653589793/r,d=numeric.rep([o],0),p=numeric.rep([o],0);Math.floor(r/2);for(l=0;r>l;l++)d[l]=e[l];if("undefined"!=typeof n)for(l=0;r>l;l++)p[l]=n[l];for(a[0]=1,l=1;o/2>=l;l++)h=m*l*l,a[l]=s(h),c[l]=f(h),a[o-l]=s(h),c[o-l]=f(h);var v=new numeric.T(d,p),y=new numeric.T(a,c);return v=v.mul(y),numeric.convpow2(v.x,v.y,numeric.clone(y.x),numeric.neg(y.y)),v=v.mul(y),v.x.length=r,v.y.length=r,v},numeric.T.prototype.ifft=function(){var l,h,e=this.x,n=this.y,r=e.length,t=Math.log,i=t(2),u=Math.ceil(t(2*r-1)/i),o=Math.pow(2,u),a=numeric.rep([o],0),c=numeric.rep([o],0),s=Math.cos,f=Math.sin,m=3.141592653589793/r,d=numeric.rep([o],0),p=numeric.rep([o],0);Math.floor(r/2);for(l=0;r>l;l++)d[l]=e[l];if("undefined"!=typeof n)for(l=0;r>l;l++)p[l]=n[l];for(a[0]=1,l=1;o/2>=l;l++)h=m*l*l,a[l]=s(h),c[l]=f(h),a[o-l]=s(h),c[o-l]=f(h);var v=new numeric.T(d,p),y=new numeric.T(a,c);return v=v.mul(y),numeric.convpow2(v.x,v.y,numeric.clone(y.x),numeric.neg(y.y)),v=v.mul(y),v.x.length=r,v.y.length=r,v.div(r)},numeric.gradient=function(e,n){var r=n.length,t=e(n);if(isNaN(t))throw new Error("gradient: f(x) is a NaN!");var u,a,c,m,v,y,x,b,C,M,i=Math.max,o=numeric.clone(n),s=Array(r),i=(numeric.div,numeric.sub,Math.max),d=.001,p=Math.abs,g=Math.min,w=0;for(u=0;r>u;u++)for(var k=i(1e-6*t,1e-8);;){if(++w,w>20)throw new Error("Numerical gradient fails");if(o[u]=n[u]+k,a=e(o),o[u]=n[u]-k,c=e(o),o[u]=n[u],isNaN(a)||isNaN(c))k/=16;else{if(s[u]=(a-c)/(2*k),v=n[u]-k,y=n[u],x=n[u]+k,b=(a-t)/k,C=(t-c)/k,M=i(p(s[u]),p(t),p(a),p(c),p(v),p(y),p(x),1e-8),m=g(i(p(b-s[u]),p(C-s[u]),p(b-C))/M,k/M),!(m>d))break;k/=16}}return s},numeric.uncmin=function(e,n,r,t,i,u,o){var a=numeric.gradient;"undefined"==typeof o&&(o={}),"undefined"==typeof r&&(r=1e-8),"undefined"==typeof t&&(t=function(n){return a(e,n)}),"undefined"==typeof i&&(i=1e3),n=numeric.clone(n);var f,l,c=n.length,s=e(n);if(isNaN(s))throw new Error("uncmin: f(x0) is a NaN!");var m=Math.max,h=numeric.norm2;r=m(r,numeric.epsilon);var d,p,g,A,j,O,E,_,V,B,v=o.Hinv||numeric.identity(c),y=numeric.dot,w=(numeric.inv,numeric.sub),b=numeric.add,C=numeric.tensor,M=numeric.div,k=numeric.mul,T=numeric.all,I=numeric.isFinite,D=numeric.neg,P=0,W="";for(p=t(n);i>P;){if("function"==typeof u&&u(P,n,s,p,v)){W="Callback returned true";break}if(!T(I(p))){W="Gradient has Infinity or NaN";break}if(d=D(y(v,p)),!T(I(d))){W="Search direction has Infinity or NaN";break}if(B=h(d),r>B){W="Newton step smaller than tol";break}for(V=1,l=y(p,d),j=n;i>P&&!(r>V*B)&&(A=k(d,V),j=b(n,A),f=e(j),f-s>=.1*V*l||isNaN(f));)V*=.5,++P;if(r>V*B){W="Line search step size smaller than tol";break}if(P===i){W="maxit reached during line search";break}g=t(j),O=w(g,p),_=y(O,A),E=y(v,O),v=w(b(v,k((_+y(O,E))/(_*_),C(A,A))),M(b(C(E,A),C(A,E)),_)),n=j,s=f,p=g,++P}return{solution:n,f:s,gradient:p,invHessian:v,iterations:P,message:W}},numeric.Dopri=function(e,n,r,t,i,u,o){this.x=e,this.y=n,this.f=r,this.ymid=t,this.iterations=i,this.events=o,this.message=u},numeric.Dopri.prototype._at=function(e,n){function r(e){return e*e}var s,f,l,m,h,d,e,g,b,C,M,t=this,i=t.x,u=t.y,o=t.f,a=t.ymid,v=(i.length,Math.floor,.5),y=numeric.add,x=numeric.mul,w=numeric.sub;return s=i[n],f=i[n+1],m=u[n],h=u[n+1],g=f-s,l=s+v*g,d=a[n],b=w(o[n],x(m,1/(s-l)+2/(s-f))),C=w(o[n+1],x(h,1/(f-l)+2/(f-s))),M=[r(e-f)*(e-l)/r(s-f)/(s-l),r(e-s)*r(e-f)/r(s-l)/r(f-l),r(e-s)*(e-l)/r(f-s)/(f-l),(e-s)*r(e-f)*(e-l)/r(s-f)/(s-l),(e-f)*r(e-s)*(e-l)/r(s-f)/(f-l)],y(y(y(y(x(m,M[0]),x(d,M[1])),x(h,M[2])),x(b,M[3])),x(C,M[4]))},numeric.Dopri.prototype.at=function(e){var n,r,t,i=Math.floor;if("number"!=typeof e){var u=e.length,o=Array(u);for(n=u-1;-1!==n;--n)o[n]=this.at(e[n]);return o}var a=this.x;for(n=0,r=a.length-1;r-n>1;)t=i(.5*(n+r)),a[t]<=e?n=t:r=t;return this._at(e,n)},numeric.dopri=function(e,n,r,t,i,u,o){"undefined"==typeof i&&(i=1e-6),"undefined"==typeof u&&(u=1e3);var f,l,m,h,d,p,D,P,E,F,X,z,Y,a=[e],c=[r],s=[t(e,r)],g=[],v=.2,y=[.075,.225],x=[44/45,-56/15,32/9],w=[19372/6561,-25360/2187,64448/6561,-212/729],b=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],C=[35/384,0,500/1113,125/192,-2187/6784,11/84],M=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],k=[.2,.3,.8,8/9,1,1],T=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],I=0,S=(n-e)/10,A=0,j=numeric.add,O=numeric.mul,L=(Math.max,Math.min),V=Math.abs,B=numeric.norminf,N=Math.pow,q=numeric.any,W=numeric.lt,R=numeric.and,Q=(numeric.sub,new numeric.Dopri(a,c,s,g,-1,""));for("function"==typeof o&&(X=o(e,r));n>e&&u>A;)if(++A,e+S>n&&(S=n-e),f=t(e+k[0]*S,j(r,O(v*S,s[I]))),l=t(e+k[1]*S,j(j(r,O(y[0]*S,s[I])),O(y[1]*S,f))),m=t(e+k[2]*S,j(j(j(r,O(x[0]*S,s[I])),O(x[1]*S,f)),O(x[2]*S,l))),h=t(e+k[3]*S,j(j(j(j(r,O(w[0]*S,s[I])),O(w[1]*S,f)),O(w[2]*S,l)),O(w[3]*S,m))),d=t(e+k[4]*S,j(j(j(j(j(r,O(b[0]*S,s[I])),O(b[1]*S,f)),O(b[2]*S,l)),O(b[3]*S,m)),O(b[4]*S,h))),E=j(j(j(j(j(r,O(s[I],S*C[0])),O(l,S*C[2])),O(m,S*C[3])),O(h,S*C[4])),O(d,S*C[5])),p=t(e+S,E),D=j(j(j(j(j(O(s[I],S*T[0]),O(l,S*T[2])),O(m,S*T[3])),O(h,S*T[4])),O(d,S*T[5])),O(p,S*T[6])),F="number"==typeof D?V(D):B(D),F>i){if(S=.2*S*N(i/F,.25),e+S===e){Q.msg="Step size became too small";break}}else{if(g[I]=j(j(j(j(j(j(r,O(s[I],S*M[0])),O(l,S*M[2])),O(m,S*M[3])),O(h,S*M[4])),O(d,S*M[5])),O(p,S*M[6])),++I,a[I]=e+S,c[I]=E,s[I]=p,"function"==typeof o){var J,G,Z=e,H=e+.5*S;if(z=o(H,g[I-1]),Y=R(W(X,0),W(0,z)),q(Y)||(Z=H,H=e+S,X=z,z=o(H,E),Y=R(W(X,0),W(0,z))),q(Y)){for(var ee,ne,re=0,te=1,ie=1;;){if("number"==typeof X)G=(ie*z*Z-te*X*H)/(ie*z-te*X);else for(G=H,P=X.length-1;-1!==P;--P)X[P]<0&&z[P]>0&&(G=L(G,(ie*z[P]*Z-te*X[P]*H)/(ie*z[P]-te*X[P])));if(Z>=G||G>=H)break;J=Q._at(G,I-1),ne=o(G,J),ee=R(W(X,0),W(0,ne)),q(ee)?(H=G,z=ne,Y=ee,ie=1,-1===re?te*=.5:te=1,re=-1):(Z=G,X=ne,te=1,1===re?ie*=.5:ie=1,re=1)}return E=Q._at(.5*(e+G),I-1),Q.f[I]=t(G,J),Q.x[I]=G,Q.y[I]=J,Q.ymid[I-1]=E,Q.events=Y,Q.iterations=A,Q}}e+=S,r=E,X=z,S=L(.8*S*N(i/F,.25),4*S)}return Q.iterations=A,Q},numeric.LU=function(e,n){n=n||!1;var t,i,u,o,a,c,s,f,l,r=Math.abs,m=e.length,h=m-1,d=new Array(m);for(n||(e=numeric.clone(e)),u=0;m>u;++u){for(s=u,c=e[u],l=r(c[u]),i=u+1;m>i;++i)o=r(e[i][u]),o>l&&(l=o,s=i);for(d[u]=s,s!=u&&(e[u]=e[s],e[s]=c,c=e[u]),a=c[u],t=u+1;m>t;++t)e[t][u]/=a;for(t=u+1;m>t;++t){for(f=e[t],i=u+1;h>i;++i)f[i]-=f[u]*c[i],++i,f[i]-=f[u]*c[i];i===h&&(f[i]-=f[u]*c[i])}}return{LU:e,P:d}},numeric.LUsolve=function(e,n){var r,t,c,s,l,i=e.LU,u=i.length,o=numeric.clone(n),a=e.P;for(r=u-1;-1!==r;--r)o[r]=n[r];for(r=0;u>r;++r)for(c=a[r],a[r]!==r&&(l=o[r],o[r]=o[c],o[c]=l),s=i[r],t=0;r>t;++t)o[r]-=o[t]*s[t];for(r=u-1;r>=0;--r){for(s=i[r],t=r+1;u>t;++t)o[r]-=o[t]*s[t];o[r]/=s[r]}return o},numeric.solve=function(e,n,r){return numeric.LUsolve(numeric.LU(e,r),n)},numeric.echelonize=function(e){var o,a,c,s,f,l,m,h,n=numeric.dim(e),r=n[0],t=n[1],i=numeric.identity(r),u=Array(r),d=Math.abs,p=numeric.diveq;for(e=numeric.clone(e),o=0;r>o;++o){for(c=0,f=e[o],l=i[o],a=1;t>a;++a)d(f[c])<d(f[a])&&(c=a);for(u[o]=c,p(l,f[c]),p(f,f[c]),a=0;r>a;++a)if(a!==o){for(m=e[a],h=m[c],s=t-1;-1!==s;--s)m[s]-=f[s]*h;for(m=i[a],s=r-1;-1!==s;--s)m[s]-=l[s]*h}}return{I:i,A:e,P:u}},numeric.__solveLP=function(e,n,r,t,i,u,o){var g,B,W,U,a=numeric.sum,s=(numeric.log,numeric.mul),f=numeric.sub,l=numeric.dot,m=numeric.div,h=numeric.add,d=e.length,p=r.length,v=!1,x=0,w=1,T=(numeric.transpose(n),numeric.svd,numeric.transpose),D=(numeric.leq,Math.sqrt),P=Math.abs,O=(numeric.muleq,numeric.norminf,numeric.any,Math.min),E=numeric.all,F=numeric.gt,_=Array(d),L=Array(p),N=(numeric.rep([p],1),numeric.solve),q=f(r,l(n,u)),R=l(e,e);for(W=x;i>W;++W){var X,Y;for(X=p-1;-1!==X;--X)L[X]=m(n[X],q[X]);var Q=T(L);for(X=d-1;-1!==X;--X)_[X]=a(Q[X]);w=.25*P(R/l(e,_));var J=100*D(R/l(_,_));for((!isFinite(w)||w>J)&&(w=J),U=h(e,s(w,_)),B=l(Q,L),X=d-1;-1!==X;--X)B[X][X]+=1;Y=N(B,m(U,w),!0);var Z=m(q,l(n,Y)),H=1;for(X=p-1;-1!==X;--X)Z[X]<0&&(H=O(H,-.999*Z[X]));if(g=f(u,s(Y,H)),q=f(r,l(n,g)),!E(F(q,0)))return{solution:u,message:"",iterations:W};if(u=g,t>w)return{solution:g,message:"",iterations:W};if(o){var G=l(e,U),$=l(n,U);for(v=!0,X=p-1;-1!==X;--X)if(G*$[X]<0){v=!1;break}}else v=u[d-1]>=0?!1:!0;if(v)return{solution:g,message:"Unbounded",iterations:W}}return{solution:u,message:"maximum iteration count exceeded",iterations:W}},numeric._solveLP=function(e,n,r,t,i){var a,u=e.length,o=r.length,l=(numeric.sum,numeric.log,numeric.mul,numeric.sub),m=numeric.dot,p=(numeric.div,numeric.add,numeric.rep([u],0).concat([1])),g=numeric.rep([o,1],-1),v=numeric.blockMatrix([[n,g]]),y=r,a=numeric.rep([u],0).concat(Math.max(0,numeric.sup(numeric.neg(r)))+1),x=numeric.__solveLP(p,v,y,t,i,a,!1),w=numeric.clone(x.solution);w.length=u;var b=numeric.inf(l(r,m(n,w)));if(0>b)return{solution:NaN,message:"Infeasible",iterations:x.iterations};var C=numeric.__solveLP(e,n,r,t,i-x.iterations,w,!0);return C.iterations+=x.iterations,C},numeric.solveLP=function(e,n,r,t,i,u,o){if("undefined"==typeof o&&(o=1e3),"undefined"==typeof u&&(u=numeric.epsilon),"undefined"==typeof t)return numeric._solveLP(e,n,r,u,o);var d,a=t.length,c=t[0].length,s=n.length,f=numeric.echelonize(t),l=numeric.rep([c],0),m=f.P,h=[];for(d=m.length-1;-1!==d;--d)l[m[d]]=1;for(d=c-1;-1!==d;--d)0===l[d]&&h.push(d);var p=numeric.getRange,g=numeric.linspace(0,a-1),v=numeric.linspace(0,s-1),y=p(t,g,h),x=p(n,v,m),w=p(n,v,h),b=numeric.dot,C=numeric.sub,M=b(x,f.I),k=C(w,b(M,y)),T=C(r,b(M,i)),I=Array(m.length),D=Array(h.length);for(d=m.length-1;-1!==d;--d)I[d]=e[m[d]];for(d=h.length-1;-1!==d;--d)D[d]=e[h[d]];var P=C(D,b(I,b(f.I,y))),S=numeric._solveLP(P,k,T,u,o),A=S.solution;if(A!==A)return S;var j=b(f.I,C(i,b(y,A))),O=Array(e.length);for(d=m.length-1;-1!==d;--d)O[m[d]]=j[d];for(d=h.length-1;-1!==d;--d)O[h[d]]=A[d];return{solution:O,message:S.message,iterations:S.iterations}},numeric.MPStoLP=function(e){function n(n){throw new Error("MPStoLP: "+n+"\nLine "+u+": "+e[u]+"\nCurrent state: "+t[r]+"\n")}e instanceof String&&e.split("\n");var u,o,a,d,r=0,t=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],i=e.length,c=0,s={},f=[],l=0,m={},h=0,p=[],g=[],v=[];for(u=0;i>u;++u){a=e[u];var y=a.match(/\S*/g),x=[];for(o=0;o<y.length;++o)""!==y[o]&&x.push(y[o]);if(0!==x.length){for(o=0;o<t.length&&a.substr(0,t[o].length)!==t[o];++o);if(o<t.length){if(r=o,1===o&&(d=x[1]),6===o)return{name:d,c:p,A:numeric.transpose(g),b:v,rows:s,vars:m}}else switch(r){case 0:case 1:n("Unexpected line");case 2:switch(x[0]){case"N":0===c?c=x[1]:n("Two or more N rows");break;case"L":s[x[1]]=l,f[l]=1,v[l]=0,++l;break;case"G":s[x[1]]=l,f[l]=-1,v[l]=0,++l;break;case"E":s[x[1]]=l,f[l]=0,v[l]=0,++l;break;default:n("Parse error "+numeric.prettyPrint(x))}break;case 3:m.hasOwnProperty(x[0])||(m[x[0]]=h,p[h]=0,g[h]=numeric.rep([l],0),++h);var w=m[x[0]];for(o=1;o<x.length;o+=2)if(x[o]!==c){var b=s[x[o]];g[w][b]=(f[b]<0?-1:1)*parseFloat(x[o+1])}else p[w]=parseFloat(x[o+1]);break;case 4:for(o=1;o<x.length;o+=2)v[s[x[o]]]=(f[s[x[o]]]<0?-1:1)*parseFloat(x[o+1]);break;case 5:break;case 6:n("Internal error")}}}n("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(e,n,r,t,i,u,o){function a(e){var n,t,i=this,u=e.length,o=0,a=i.i=i.j=i.m=0;for(i.S=[],i.c=[],u||(e=[u++]);r>o;)i.S[o]=o++;for(o=0;r>o;o++)n=i.S[o],a=f(a+n+e[o%u]),t=i.S[a],i.S[o]=t,i.S[a]=n;i.g=function(e){var n=i.S,t=f(i.i+1),u=n[t],o=f(i.j+u),a=n[o];n[t]=a,n[o]=u;for(var c=n[f(u+a)];--e;)t=f(t+1),u=n[t],o=f(o+u),a=n[o],n[t]=a,n[o]=u,c=c*r+n[f(u+a)];return i.i=t,i.j=o,c},i.g(r)}function c(e,n,r,t,i){if(r=[],i=typeof e,n&&"object"==i)for(t in e)if(t.indexOf("S")<5)try{r.push(c(e[t],n-1))}catch(u){}return r.length?r:e+("string"!=i?"\x00":"")}function s(e,n,r,t){for(e+="",r=0,t=0;t<e.length;t++)n[f(t)]=f((r^=19*n[f(t)])+e.charCodeAt(t));e="";for(t in n)e+=String.fromCharCode(n[t]);return e}function f(e){return e&r-1}n.seedrandom=function(f,l){var h,m=[];return f=s(c(l?[f,e]:arguments.length?f:[(new Date).getTime(),e,window],3),m),h=new a(m),s(h.S,e),n.random=function(){for(var e=h.g(t),n=o,a=0;i>e;)e=(e+a)*r,n*=r,a=h.g(1);for(;e>=u;)e/=2,n/=2,a>>>=1;return(e+a)/n},f},o=n.pow(r,t),i=n.pow(2,i),u=2*i,s(n.random(),e)}([],numeric.seedrandom,256,6,52),function(e){function n(e){if("object"!=typeof e)return e;var t,r=[],i=e.length;for(t=0;i>t;t++)r[t+1]=n(e[t]);return r}function r(e){if("object"!=typeof e)return e;var t,n=[],i=e.length;for(t=1;i>t;t++)n[t-1]=r(e[t]);return n}function t(e,n,r){var t,i,u,o,a;for(u=1;r>=u;u+=1){for(e[u][u]=1/e[u][u],a=-e[u][u],t=1;u>t;t+=1)e[t][u]=a*e[t][u];if(o=u+1,o>r)break;for(i=o;r>=i;i+=1)for(a=e[u][i],e[u][i]=0,t=1;u>=t;t+=1)e[t][i]=e[t][i]+a*e[t][u]}}function i(e,n,r,t){var i,u,o,a;for(u=1;r>=u;u+=1){for(a=0,i=1;u>i;i+=1)a+=e[i][u]*t[i];t[u]=(t[u]-a)/e[u][u]}for(o=1;r>=o;o+=1)for(u=r+1-o,t[u]=t[u]/e[u][u],a=-t[u],i=1;u>i;i+=1)t[i]=t[i]+a*e[i][u]}function u(e,n,r,t){var i,u,o,a,c,s;for(u=1;r>=u;u+=1){if(t[1]=u,s=0,o=u-1,1>o){if(s=e[u][u]-s,0>=s)break;e[u][u]=Math.sqrt(s)}else{for(a=1;o>=a;a+=1){for(c=e[a][u],i=1;a>i;i+=1)c-=e[i][u]*e[i][a];c/=e[a][a],e[a][u]=c,s+=c*c}if(s=e[u][u]-s,0>=s)break;e[u][u]=Math.sqrt(s)}t[1]=0}}function o(e,n,r,o,a,c,s,f,l,m,h,d,p,g,v,y){function x(){for(g[1]=g[1]+1,I=E,k=1;m>=k;k+=1){for(I+=1,N=-f[k],T=1;o>=T;T+=1)N+=s[T][k]*a[T];if(Math.abs(N)<Q&&(N=0),k>h)v[I]=N;else if(v[I]=-Math.abs(N),N>0){for(T=1;o>=T;T+=1)s[T][k]=-s[T][k];f[k]=-f[k]}}for(k=1;p>=k;k+=1)v[E+d[k]]=0;for(_=0,B=0,k=1;m>=k;k+=1)v[E+k]<B*v[V+k]&&(_=k,B=v[E+k]/v[V+k]);return 0===_?999:0}function w(){for(k=1;o>=k;k+=1){for(N=0,
T=1;o>=T;T+=1)N+=e[T][k]*s[T][_];v[k]=N}for(D=A,k=1;o>=k;k+=1)v[D+k]=0;for(T=p+1;o>=T;T+=1)for(k=1;o>=k;k+=1)v[D+k]=v[D+k]+e[k][T]*v[T];for(z=!0,k=p;k>=1;k-=1){for(N=v[k],I=O+k*(k+3)/2,D=I-k,T=k+1;p>=T;T+=1)N-=v[I]*v[j+T],I+=T;if(N/=v[D],v[j+k]=N,d[k]<h)break;if(0>N)break;z=!1,S=k}if(!z)for(q=v[F+S]/v[j+S],k=1;p>=k&&!(d[k]<h)&&!(v[j+k]<0);k+=1)B=v[F+k]/v[j+k],q>B&&(q=B,S=k);for(N=0,k=A+1;A+o>=k;k+=1)N+=v[k]*v[k];if(Math.abs(N)<=Q){if(z)return y[1]=1,999;for(k=1;p>=k;k+=1)v[F+k]=v[F+k]-q*v[j+k];return v[F+p+1]=v[F+p+1]+q,700}for(N=0,k=1;o>=k;k+=1)N+=v[A+k]*s[k][_];for(W=-v[E+_]/N,Y=!0,z||W>q&&(W=q,Y=!1),k=1;o>=k;k+=1)a[k]=a[k]+W*v[A+k],Math.abs(a[k])<Q&&(a[k]=0);for(c[1]=c[1]+W*N*(W/2+v[F+p+1]),k=1;p>=k;k+=1)v[F+k]=v[F+k]-W*v[j+k];if(v[F+p+1]=v[F+p+1]+W,!Y){for(N=-f[_],T=1;o>=T;T+=1)N+=a[T]*s[T][_];if(_>h)v[E+_]=N;else if(v[E+_]=-Math.abs(N),N>0){for(T=1;o>=T;T+=1)s[T][_]=-s[T][_];f[_]=-f[_]}return 700}for(p+=1,d[p]=_,I=O+(p-1)*p/2+1,k=1;p-1>=k;k+=1)v[I]=v[k],I+=1;if(p===o)v[I]=v[o];else{for(k=o;k>=p+1&&0!==v[k]&&(R=Math.max(Math.abs(v[k-1]),Math.abs(v[k])),U=Math.min(Math.abs(v[k-1]),Math.abs(v[k])),B=v[k-1]>=0?Math.abs(R*Math.sqrt(1+U*U/(R*R))):-Math.abs(R*Math.sqrt(1+U*U/(R*R))),R=v[k-1]/B,U=v[k]/B,1!==R);k-=1)if(0===R)for(v[k-1]=U*B,T=1;o>=T;T+=1)B=e[T][k-1],e[T][k-1]=e[T][k],e[T][k]=B;else for(v[k-1]=B,X=U/(1+R),T=1;o>=T;T+=1)B=R*e[T][k-1]+U*e[T][k],e[T][k]=X*(e[T][k-1]+B)-e[T][k],e[T][k-1]=B;v[I]=v[p]}return 0}function b(){if(I=O+S*(S+1)/2+1,D=I+S,0===v[D])return 798;if(R=Math.max(Math.abs(v[D-1]),Math.abs(v[D])),U=Math.min(Math.abs(v[D-1]),Math.abs(v[D])),B=v[D-1]>=0?Math.abs(R*Math.sqrt(1+U*U/(R*R))):-Math.abs(R*Math.sqrt(1+U*U/(R*R))),R=v[D-1]/B,U=v[D]/B,1===R)return 798;if(0===R){for(k=S+1;p>=k;k+=1)B=v[D-1],v[D-1]=v[D],v[D]=B,D+=k;for(k=1;o>=k;k+=1)B=e[k][S],e[k][S]=e[k][S+1],e[k][S+1]=B}else{for(X=U/(1+R),k=S+1;p>=k;k+=1)B=R*v[D-1]+U*v[D],v[D]=X*(v[D-1]+B)-v[D],v[D-1]=B,D+=k;for(k=1;o>=k;k+=1)B=R*e[k][S]+U*e[k][S+1],e[k][S+1]=X*(e[k][S]+B)-e[k][S+1],e[k][S]=B}return 0}function C(){for(D=I-S,k=1;S>=k;k+=1)v[D]=v[I],I+=1,D+=1;return v[F+S]=v[F+S+1],d[S]=d[S+1],S+=1,p>S?797:0}function M(){return v[F+p]=v[F+p+1],v[F+p+1]=0,d[p]=0,p-=1,g[2]=g[2]+1,0}var k,T,I,D,P,S,A,j,O,E,F,_,L,V,B,N,q,W,R,U,X,z,Y,Q,J,Z,H;L=Math.min(o,m),I=2*o+L*(L+5)/2+2*m+1,Q=1e-60;do Q+=Q,J=1+.1*Q,Z=1+.2*Q;while(1>=J||1>=Z);for(k=1;o>=k;k+=1)v[k]=n[k];for(k=o+1;I>=k;k+=1)v[k]=0;for(k=1;m>=k;k+=1)d[k]=0;if(P=[],0===y[1]){if(u(e,r,o,P),0!==P[1])return void(y[1]=2);i(e,r,o,n),t(e,r,o)}else{for(T=1;o>=T;T+=1)for(a[T]=0,k=1;T>=k;k+=1)a[T]=a[T]+e[k][T]*n[k];for(T=1;o>=T;T+=1)for(n[T]=0,k=T;o>=k;k+=1)n[T]=n[T]+e[T][k]*a[k]}for(c[1]=0,T=1;o>=T;T+=1)for(a[T]=n[T],c[1]=c[1]+v[T]*a[T],v[T]=0,k=T+1;o>=k;k+=1)e[k][T]=0;for(c[1]=-c[1]/2,y[1]=0,A=o,j=A+o,F=j+L,O=F+L+1,E=O+L*(L+1)/2,V=E+m,k=1;m>=k;k+=1){for(N=0,T=1;o>=T;T+=1)N+=s[T][k]*s[T][k];v[V+k]=Math.sqrt(N)}for(p=0,g[1]=0,g[2]=0,H=0;;){if(H=x(),999===H)return;for(;H=w(),0!==H;){if(999===H)return;if(700===H)if(S===p)M();else{for(;b(),H=C(),797===H;);M()}}}}function a(e,t,i,u,a,c){e=n(e),t=n(t),i=n(i);var s,f,l,m,h,x,d=[],p=[],g=[],v=[],y=[];if(a=a||0,c=c?n(c):[void 0,0],u=u?n(u):[],f=e.length-1,l=i[1].length-1,!u)for(s=1;l>=s;s+=1)u[s]=0;for(s=1;l>=s;s+=1)p[s]=0;for(m=0,h=Math.min(f,l),s=1;f>=s;s+=1)g[s]=0;for(d[1]=0,s=1;2*f+h*(h+5)/2+2*l+1>=s;s+=1)v[s]=0;for(s=1;2>=s;s+=1)y[s]=0;return o(e,t,f,f,g,d,i,u,f,l,a,p,m,y,v,c),x="",1===c[1]&&(x="constraints are inconsistent, no solution!"),2===c[1]&&(x="matrix D in quadratic function is not positive definite!"),{solution:r(g),value:r(d),unconstrained_solution:r(t),iterations:r(y),iact:r(p),message:x}}e.solveQP=a}(numeric),numeric.svd=function(e){function n(e,n){return e=Math.abs(e),n=Math.abs(n),e>n?e*Math.sqrt(1+n*n/e/e):0==n?e:n*Math.sqrt(1+e*e/n/n)}var r,t=numeric.epsilon,i=1e-64/t,u=50,o=0,a=0,c=0,s=0,f=0,l=numeric.clone(e),m=l.length,h=l[0].length;if(h>m)throw"Need more rows than columns";var d=new Array(h),p=new Array(h);for(a=0;h>a;a++)d[a]=p[a]=0;var g=numeric.rep([h,h],0),v=0,y=0,x=0,w=0,b=0,C=0,M=0;for(a=0;h>a;a++){for(d[a]=y,M=0,f=a+1,c=a;m>c;c++)M+=l[c][a]*l[c][a];if(i>=M)y=0;else for(v=l[a][a],y=Math.sqrt(M),v>=0&&(y=-y),x=v*y-M,l[a][a]=v-y,c=f;h>c;c++){for(M=0,s=a;m>s;s++)M+=l[s][a]*l[s][c];for(v=M/x,s=a;m>s;s++)l[s][c]+=v*l[s][a]}for(p[a]=y,M=0,c=f;h>c;c++)M+=l[a][c]*l[a][c];if(i>=M)y=0;else{for(v=l[a][a+1],y=Math.sqrt(M),v>=0&&(y=-y),x=v*y-M,l[a][a+1]=v-y,c=f;h>c;c++)d[c]=l[a][c]/x;for(c=f;m>c;c++){for(M=0,s=f;h>s;s++)M+=l[c][s]*l[a][s];for(s=f;h>s;s++)l[c][s]+=M*d[s]}}b=Math.abs(p[a])+Math.abs(d[a]),b>w&&(w=b)}for(a=h-1;-1!=a;a+=-1){if(0!=y){for(x=y*l[a][a+1],c=f;h>c;c++)g[c][a]=l[a][c]/x;for(c=f;h>c;c++){for(M=0,s=f;h>s;s++)M+=l[a][s]*g[s][c];for(s=f;h>s;s++)g[s][c]+=M*g[s][a]}}for(c=f;h>c;c++)g[a][c]=0,g[c][a]=0;g[a][a]=1,y=d[a],f=a}for(a=h-1;-1!=a;a+=-1){for(f=a+1,y=p[a],c=f;h>c;c++)l[a][c]=0;if(0!=y){for(x=l[a][a]*y,c=f;h>c;c++){for(M=0,s=f;m>s;s++)M+=l[s][a]*l[s][c];for(v=M/x,s=a;m>s;s++)l[s][c]+=v*l[s][a]}for(c=a;m>c;c++)l[c][a]=l[c][a]/y}else for(c=a;m>c;c++)l[c][a]=0;l[a][a]+=1}for(t*=w,s=h-1;-1!=s;s+=-1)for(var k=0;u>k;k++){var T=!1;for(f=s;-1!=f;f+=-1){if(Math.abs(d[f])<=t){T=!0;break}if(Math.abs(p[f-1])<=t)break}if(!T){o=0,M=1;var I=f-1;for(a=f;s+1>a&&(v=M*d[a],d[a]=o*d[a],!(Math.abs(v)<=t));a++)for(y=p[a],x=n(v,y),p[a]=x,o=y/x,M=-v/x,c=0;m>c;c++)b=l[c][I],C=l[c][a],l[c][I]=b*o+C*M,l[c][a]=-b*M+C*o}if(C=p[s],f==s){if(0>C)for(p[s]=-C,c=0;h>c;c++)g[c][s]=-g[c][s];break}if(k>=u-1)throw"Error: no convergence.";for(w=p[f],b=p[s-1],y=d[s-1],x=d[s],v=((b-C)*(b+C)+(y-x)*(y+x))/(2*x*b),y=n(v,1),v=0>v?((w-C)*(w+C)+x*(b/(v-y)-x))/w:((w-C)*(w+C)+x*(b/(v+y)-x))/w,o=1,M=1,a=f+1;s+1>a;a++){for(y=d[a],b=p[a],x=M*y,y=o*y,C=n(v,x),d[a-1]=C,o=v/C,M=x/C,v=w*o+y*M,y=-w*M+y*o,x=b*M,b*=o,c=0;h>c;c++)w=g[c][a-1],C=g[c][a],g[c][a-1]=w*o+C*M,g[c][a]=-w*M+C*o;for(C=n(v,x),p[a-1]=C,o=v/C,M=x/C,v=o*y+M*b,w=-M*y+o*b,c=0;m>c;c++)b=l[c][a-1],C=l[c][a],l[c][a-1]=b*o+C*M,l[c][a]=-b*M+C*o}d[f]=0,d[s]=v,p[s]=w}for(a=0;a<p.length;a++)p[a]<t&&(p[a]=0);for(a=0;h>a;a++)for(c=a-1;c>=0;c--)if(p[c]<p[a]){for(o=p[c],p[c]=p[a],p[a]=o,s=0;s<l.length;s++)r=l[s][a],l[s][a]=l[s][c],l[s][c]=r;for(s=0;s<g.length;s++)r=g[s][a],g[s][a]=g[s][c],g[s][c]=r;a=c}return{U:l,S:p,V:g}},stats=function(e){for(var t,n={mean:0,variance:0,deviation:0},r=e.length,i=0,u=r;u--;i+=e[u]);for(t=n.mean=i/r,u=r,i=0;u--;i+=Math.pow(e[u]-t,2));return n.deviation=Math.sqrt(n.variance=i/r),n};var generate141Matrix=function(e){result=[];for(var n=0;e>n;n++){for(var r=[],t=0;e>t;t++)t==n?r.push(4):1==Math.abs(n-t)?r.push(1):r.push(0);result.push(r)}return result},generateConstantMatrix=function(e){for(result=[],result.push(numeric.sub(numeric.mul(e[1],6),e[0])),i=2;i<e.length-2;i++)result.push(numeric.mul(e[i],6));return result.push(numeric.sub(numeric.mul(e[e.length-2],6),e[e.length-1])),result},convertBSplineControlPointsToBezierControlPoints=function(e){for(var n=[],r=0;r<e.length-1;r++){if(0==r)var t=e[0];else var t=o;var i=numeric.add(numeric.mul(2/3,e[r]),numeric.mul(1/3,e[r+1])),u=numeric.add(numeric.mul(1/3,e[r]),numeric.mul(2/3,e[r+1]));if(r==e.length-2)var o=e[e.length-1];else var o=numeric.add(numeric.mul(1/6,e[r]),numeric.mul(2/3,e[r+1]),numeric.mul(1/6,e[r+2]));var a=[t,i,u,o];n.push(a)}return n},getBezierControlPoints=function(e){if(e.length<4){if(3===e.length)return i=[e[0],e[1],e[1],e[2]],[i];if(2===e.length)return i=[e[0],e[0],e[1],e[1]],[i];if(1===e.length)return i=[e[0],e[0],e[0],e[0]],[i]}var n=generate141Matrix(e.length-2),r=generateConstantMatrix(e),t=numeric.dot(numeric.inv(n),r);t.splice(0,0,e[0]),t.push(e[e.length-1]);var i=convertBSplineControlPointsToBezierControlPoints(t);return i};!function(e){function n(n,r){function t(){clearTimeout(P),P=!1,S=!1}function i(n,r){var t,i,u;return n.preventDefault(),t=e(n.target).offset(),clearTimeout(P),P=!1,"undefined"!=typeof n.changedTouches?(i=Math.floor(n.changedTouches[0].pageX-t.left),u=Math.floor(n.changedTouches[0].pageY-t.top)):(i=Math.floor(n.pageX-t.left),u=Math.floor(n.pageY-t.top)),I.x===i&&I.y===u?!0:(null===I.x&&(I.x=i),null===I.y&&(I.y=u),r&&(u+=r),T.beginPath(),T.moveTo(I.x,I.y),T.lineTo(i,u),T.lineCap=b.penCap,T.stroke(),T.closePath(),D.push({lx:i,ly:u,mx:I.x,my:I.y}),I.x=i,I.y=u,void(b.onDraw&&"function"==typeof b.onDraw&&b.onDraw.apply(w)))}function u(n){n?i(n,1):(A?M.each(function(){this.removeEventListener("touchmove",i)}):M.unbind("mousemove.signaturepad"),D.length>0&&b.onDrawEnd&&"function"==typeof b.onDrawEnd&&b.onDrawEnd.apply(w)),I.x=null,I.y=null,b.output&&D.length>0&&e(b.output,C).val(JSON.stringify(D))}function o(){return b.lineWidth?(T.beginPath(),T.lineWidth=b.lineWidth,T.strokeStyle=b.lineColour,T.moveTo(b.lineMargin,b.lineTop),T.lineTo(k.width-b.lineMargin,b.lineTop),T.stroke(),void T.closePath()):!1}function a(){T.clearRect(0,0,k.width,k.height),T.fillStyle=b.bgColour,T.fillRect(0,0,k.width,k.height),b.displayOnly||o(),T.lineWidth=b.penWidth,T.strokeStyle=b.penColour,e(b.output,C).val(""),D=[],u()}function c(e,n){null==I.x?i(e,1):i(e,n)}function s(e,n){A?n.addEventListener("touchmove",c,!1):M.bind("mousemove.signaturepad",c),i(e,1)}function f(){j=!1,M.each(function(){this.removeEventListener&&(this.removeEventListener("touchend",u),this.removeEventListener("touchcancel",u),this.removeEventListener("touchmove",i)),this.ontouchstart&&(this.ontouchstart=null)}),e(document).unbind("mouseup.signaturepad"),M.unbind("mousedown.signaturepad"),M.unbind("mousemove.signaturepad"),M.unbind("mouseleave.signaturepad"),e(b.clear,C).unbind("click.signaturepad")}function l(n){return j?!1:(j=!0,e("input").blur(),"undefined"!=typeof n.changedTouches&&(A=!0),void(A?(M.each(function(){this.addEventListener("touchend",u,!1),this.addEventListener("touchcancel",u,!1)}),M.unbind("mousedown.signaturepad")):(e(document).bind("mouseup.signaturepad",function(){S&&(u(),t())}),M.bind("mouseleave.signaturepad",function(e){S&&u(e),S&&!P&&(P=setTimeout(function(){u(),t()},500))}),M.each(function(){this.ontouchstart=null}))))}function m(){e(b.typed,C).hide(),a(),M.each(function(){this.ontouchstart=function(e){e.preventDefault(),S=!0,l(e),s(e,this)}}),M.bind("mousedown.signaturepad",function(e){e.preventDefault(),S=!0,l(e),s(e)}),e(b.clear,C).bind("click.signaturepad",function(e){e.preventDefault(),a()}),e(b.typeIt,C).bind("click.signaturepad",function(e){e.preventDefault(),h()}),e(b.drawIt,C).unbind("click.signaturepad"),e(b.drawIt,C).bind("click.signaturepad",function(e){e.preventDefault()}),e(b.typeIt,C).removeClass(b.currentClass),e(b.drawIt,C).addClass(b.currentClass),e(b.sig,C).addClass(b.currentClass),e(b.typeItDesc,C).hide(),e(b.drawItDesc,C).show(),e(b.clear,C).show()}function h(){a(),f(),e(b.typed,C).show(),e(b.drawIt,C).bind("click.signaturepad",function(e){e.preventDefault(),m()}),e(b.typeIt,C).unbind("click.signaturepad"),e(b.typeIt,C).bind("click.signaturepad",function(e){e.preventDefault()}),e(b.output,C).val(""),e(b.drawIt,C).removeClass(b.currentClass),e(b.typeIt,C).addClass(b.currentClass),e(b.sig,C).removeClass(b.currentClass),e(b.drawItDesc,C).hide(),e(b.clear,C).hide(),e(b.typeItDesc,C).show(),E=O=e(b.typed,C).css("font-size").replace(/px/,"")}function d(n){var r=e(b.typed,C),t=n.replace(/>/g,"&gt;").replace(/</g,"&lt;").trim(),i=F,u=.5*E;if(F=t.length,r.html(t),!t)return void r.css("font-size",O+"px");if(F>i&&r.outerWidth()>k.width)for(;r.outerWidth()>k.width;)E--,r.css("font-size",E+"px");if(i>F&&r.outerWidth()+u<k.width&&O>E)for(;r.outerWidth()+u<k.width&&O>E;)E++,r.css("font-size",E+"px")}function p(n,r){e("p."+r.errorClass,n).remove(),n.removeClass(r.errorClass),e("input, label",n).removeClass(r.errorClass)}function g(n,r,t){n.nameInvalid&&(r.prepend(['<p class="',t.errorClass,'">',t.errorMessage,"</p>"].join("")),e(t.name,r).focus(),e(t.name,r).addClass(t.errorClass),e("label[for="+e(t.name).attr("id")+"]",r).addClass(t.errorClass)),n.drawInvalid&&r.prepend(['<p class="',t.errorClass,'">',t.errorMessageDraw,"</p>"].join(""))}function v(){var n=!0,r={drawInvalid:!1,nameInvalid:!1},t=[C,b],i=[r,C,b];return b.onBeforeValidate&&"function"==typeof b.onBeforeValidate?b.onBeforeValidate.apply(w,t):p.apply(w,t),b.drawOnly&&D.length<1&&(r.drawInvalid=!0,n=!1),""===e(b.name,C).val()&&(r.nameInvalid=!0,n=!1),b.onFormError&&"function"==typeof b.onFormError?b.onFormError.apply(w,i):g.apply(w,i),n}function y(e,n,r){for(var t in e)"object"==typeof e[t]&&(n.beginPath(),n.moveTo(e[t].mx,e[t].my),n.lineTo(e[t].lx,e[t].ly),n.lineCap=b.penCap,n.stroke(),n.closePath(),r&&D.push({lx:e[t].lx,ly:e[t].ly,mx:e[t].mx,my:e[t].my}))}function x(){parseFloat((/CPU.+OS ([0-9_]{3}).*AppleWebkit.*Mobile/i.exec(navigator.userAgent)||[0,"4_2"])[1].replace("_","."))<4.1&&(e.fn.Oldoffset=e.fn.offset,e.fn.offset=function(){var n=e(this).Oldoffset();return n.top-=window.scrollY,n.left-=window.scrollX,n}),e(b.typed,C).bind("selectstart.signaturepad",function(n){return e(n.target).is(":input")}),M.bind("selectstart.signaturepad",function(n){return e(n.target).is(":input")}),!k.getContext&&FlashCanvas&&FlashCanvas.initElement(k),k.getContext&&(T=k.getContext("2d"),e(b.sig,C).show(),b.displayOnly||(b.drawOnly||(e(b.name,C).bind("keyup.signaturepad",function(){d(e(this).val())}),e(b.name,C).bind("blur.signaturepad",function(){d(e(this).val())}),e(b.drawIt,C).bind("click.signaturepad",function(e){e.preventDefault(),m()})),b.drawOnly||"drawIt"===b.defaultAction?m():h(),b.validateFields&&(e(n).is("form")?e(n).bind("submit.signaturepad",function(){return v()}):e(n).parents("form").bind("submit.signaturepad",function(){return v()})),e(b.sigNav,C).show()))}var w=this,b=e.extend({},e.fn.signaturePad.defaults,r),C=e(n),M=e(b.canvas,C),k=M.get(0),T=null,I={x:null,y:null},D=[],P=!1,S=!1,A=!1,j=!1,O=30,E=O,F=0;e.extend(w,{init:function(){x()},updateOptions:function(n){e.extend(b,n)},regenerate:function(n){w.clearCanvas(),e(b.typed,C).hide(),"string"==typeof n&&(n=JSON.parse(n)),y(n,T,!0),b.output&&e(b.output,C).length>0&&e(b.output,C).val(JSON.stringify(D))},clearCanvas:function(){a()},getSignature:function(){return D},getSignatureString:function(){return JSON.stringify(D)},getSignatureImage:function(){var e=document.createElement("canvas"),n=null,r=null;return e.style.position="absolute",e.style.top="-999em",e.width=k.width,e.height=k.height,document.body.appendChild(e),!e.getContext&&FlashCanvas&&FlashCanvas.initElement(e),n=e.getContext("2d"),n.fillStyle=b.bgColour,n.fillRect(0,0,k.width,k.height),n.lineWidth=b.penWidth,n.strokeStyle=b.penColour,y(D,n),r=e.toDataURL.apply(e,arguments),document.body.removeChild(e),e=null,r},validateForm:function(){return v()}})}e.fn.signaturePad=function(r){var t=null;return this.each(function(){e.data(this,"plugin-signaturePad")?(t=e.data(this,"plugin-signaturePad"),t.updateOptions(r)):(t=new n(this,r),t.init(),e.data(this,"plugin-signaturePad",t))}),t},e.fn.signaturePad.defaults={defaultAction:"typeIt",displayOnly:!1,drawOnly:!1,canvas:"canvas",sig:".sig",sigNav:".sigNav",bgColour:"#ffffff",penColour:"#145394",penWidth:2,penCap:"round",lineColour:"#ccc",lineWidth:2,lineMargin:5,lineTop:35,name:".name",typed:".typed",clear:".clearButton",typeIt:".typeIt a",drawIt:".drawIt a",typeItDesc:".typeItDesc",drawItDesc:".drawItDesc",output:".output",currentClass:"current",validateFields:!0,errorClass:"error",errorMessage:"Please enter your name",errorMessageDraw:"Please sign the document",onBeforeValidate:null,onFormError:null,onDraw:null,onDrawEnd:null}}(jQuery);